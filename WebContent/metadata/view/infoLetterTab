{
    "type": "Ext.panel.Panel",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userAlias": "infoLetterTab",
        "designer|userClassName": "infoLetterTab",
        "id": "infoLetterTab",
        "layout": "fit",
        "title": "监管>>群众来信"
    },
    "designerId": "31c5b39f-20c7-44c8-8d54-7ebd7759f753",
    "cn": [
        {
            "type": "Ext.form.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "autoScroll": true,
                "bodyPadding": 10,
                "dock": null,
                "height": 421,
                "jsonSubmit": true,
                "layout": "border",
                "pollForChanges": null,
                "title": null
            },
            "name": "MyForm41",
            "designerId": "55f311ee-0b75-4f82-9d38-e10be9829b79",
            "cn": [
                {
                    "type": "Ext.grid.Panel",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "collapsible": false,
                        "forceFit": true,
                        "id": "letterGridPanel",
                        "layout|region": "center",
                        "store": "InfoLetterStore",
                        "title": ""
                    },
                    "name": "MyGridPanel40",
                    "designerId": "6d2b82ab-e42d-4370-b0bc-fd629715b4b2",
                    "cn": [
                        {
                            "type": "Ext.grid.RowNumberer",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "text": null,
                                "width": 37
                            },
                            "name": "MyRowNumberer33",
                            "designerId": "c23d391c-1dfd-4935-b441-db4daa02fe6b"
                        },
                        {
                            "type": "Ext.grid.column.Column",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "letterTitle",
                                "text": "来信主题"
                            },
                            "name": "MyColumn207",
                            "designerId": "6b8314a2-df0f-439f-839c-e1395265ad03"
                        },
                        {
                            "type": "Ext.grid.column.Column",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "letterAuthor",
                                "text": "来信人"
                            },
                            "name": "MyColumn208",
                            "designerId": "fc2d0ffd-4c86-4075-b56f-52910eb2e2d3"
                        },
                        {
                            "type": "Ext.grid.column.Date",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "letterWritetime",
                                "format": "Y-m-d",
                                "text": "来信时间"
                            },
                            "name": "MyDateColumn37",
                            "designerId": "b0747767-0497-469f-be9c-66bb05386ca8"
                        },
                        {
                            "type": "Ext.grid.column.Column",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "letterIsreply",
                                "text": "是否回复"
                            },
                            "name": "MyColumn209",
                            "designerId": "b30f5e52-c600-4651-bacf-9e6b3bfba23a"
                        },
                        {
                            "type": "Ext.grid.column.Column",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "letterIsshow",
                                "text": "是否公示"
                            },
                            "name": "MyColumn210",
                            "designerId": "f563acaa-4ef7-460b-843f-1a7cf2fe8ac3"
                        },
                        {
                            "type": "Ext.grid.View",
                            "reference": {
                                "name": "viewConfig",
                                "type": "object"
                            },
                            "codeClass": null,
                            "name": "MyGridView40",
                            "designerId": "4d2ac806-0185-4479-b143-553e44d9feba"
                        },
                        {
                            "type": "Ext.selection.CheckboxModel",
                            "reference": {
                                "name": "selModel",
                                "type": "object"
                            },
                            "codeClass": "Ext.selection.CheckboxModel",
                            "name": "MyCheckboxSelectionModel32",
                            "designerId": "086106e9-016e-4f58-900c-710212e41b1c"
                        },
                        {
                            "type": "Ext.toolbar.Toolbar",
                            "reference": {
                                "name": "dockedItems",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dock": "top",
                                "enableOverflow": true,
                                "frame": false,
                                "height": null
                            },
                            "name": "MyToolbar54",
                            "designerId": "485c68dd-4023-420d-bf23-09e34234324f",
                            "cn": [
                                {
                                    "type": "Ext.form.field.Date",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fieldLabel": "起始时间",
                                        "format": "Y-m-d",
                                        "id": "searchDateLetter",
                                        "labelWidth": 80,
                                        "layout|flex": null,
                                        "width": 234
                                    },
                                    "name": "MyDateField47",
                                    "designerId": "4dad52cb-8736-48a2-9a20-76f7661aa56b"
                                },
                                {
                                    "type": "Ext.form.field.Text",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "designer|displayName": null,
                                        "emptyText": "请输入搜索关键字",
                                        "fieldLabel": "",
                                        "id": "searchKeywordLetter",
                                        "labelWidth": 80,
                                        "layout|flex": null,
                                        "width": 159
                                    },
                                    "name": "MyTextField211",
                                    "designerId": "2d3a6892-5103-41f2-ba64-67bf254043dc"
                                },
                                {
                                    "type": "Ext.button.Button",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "icon": "images/file_view0.png",
                                        "layout|flex": null,
                                        "text": "搜索"
                                    },
                                    "name": "MyButton217",
                                    "designerId": "5f5d037b-8a9a-46ca-a32d-ff50f620fdc1",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "button",
                                                    "event"
                                                ],
                                                "fn": "handler",
                                                "implHandler": [
                                                    "var getDate = Ext.util.Format.date(Ext.getCmp('searchDateLetter').getValue(),'Y-m-d');\r",
                                                    "var getKeyword = Ext.getCmp('searchKeywordLetter').getValue();\r",
                                                    "var mystore=Ext.StoreMgr.get('InfoLetterStore'); //获得store对象\r",
                                                    "//在load事件中添加参数\r",
                                                    "//mystore.load(\r",
                                                    "//{params:{\r",
                                                    "//    start:\"0\",\r",
                                                    "//    limit:\"25\",\r",
                                                    "//    searchKeyword:getKeyword,\r",
                                                    "//    searchDate:getDate   \r",
                                                    "//} \r",
                                                    "//}\r",
                                                    "//);\r",
                                                    "\r",
                                                    "\r",
                                                    "\r",
                                                    "mystore.on('beforeload',function(store,options){\r",
                                                    "\r",
                                                    "    var new_params = { \r",
                                                    "        searchKeyword:getKeyword,\r",
                                                    "        searchDate:getDate\r",
                                                    "    };\r",
                                                    "\r",
                                                    "    Ext.apply(store.proxy.extraParams,new_params);\r",
                                                    "});\r",
                                                    "\r",
                                                    "mystore.load(\r",
                                                    "{\r",
                                                    "    params:{\r",
                                                    "        start:\"0\",\r",
                                                    "        limit:\"25\"\r",
                                                    "    }\r",
                                                    "}\r",
                                                    ");"
                                                ]
                                            },
                                            "name": "handler",
                                            "designerId": "b32c842f-4772-42bf-9b61-a661abb1334d"
                                        }
                                    ]
                                },
                                {
                                    "type": "Ext.button.Button",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "icon": "images/table_delete.png",
                                        "layout|flex": null,
                                        "text": "删除来信"
                                    },
                                    "name": "MyButton218",
                                    "designerId": "5815dd7b-ccad-4e1d-a286-f88917200250",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "button",
                                                    "event"
                                                ],
                                                "fn": "handler",
                                                "implHandler": [
                                                    "var grid = Ext.getCmp('letterGridPanel');\r",
                                                    "\r",
                                                    "var record = grid.getSelectionModel().getSelection();\r",
                                                    "\r",
                                                    "if(record.length === 0){\r",
                                                    "    Ext.Msg.alert('提示','请先选择您要操作的行！');    \r",
                                                    "    return;\r",
                                                    "\r",
                                                    "}else{\r",
                                                    "\r",
                                                    "    var  letterIds =new Array(record.length);\r",
                                                    "    for(var i = 0;i<record.length;i++){\r",
                                                    "        letterIds[i] = record[i].get(\"letterId\");\r",
                                                    "\r",
                                                    "    }\r",
                                                    "    Ext.Msg.alert('提示',letterIds);\r",
                                                    "\r",
                                                    "\r",
                                                    "\r",
                                                    "    Ext.Ajax.request({\r",
                                                    "        url:'del_letterByIds',\r",
                                                    "        params:{letterIds:letterIds},\r",
                                                    "\r",
                                                    "        success:function(response){\r",
                                                    "            Ext.Msg.alert('成功','信件已删除');\r",
                                                    "            var mystore = Ext.StoreMgr.get('InfoLetterStore');\r",
                                                    "            mystore.load();\r",
                                                    "\r",
                                                    "\r",
                                                    "        }\r",
                                                    "\r",
                                                    "    });\r",
                                                    "\r",
                                                    "}"
                                                ]
                                            },
                                            "name": "handler",
                                            "designerId": "114e4a8f-bf4d-400b-a2f2-d0e6700edce1"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "Ext.toolbar.Paging",
                            "reference": {
                                "name": "dockedItems",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "displayInfo": true,
                                "dock": "bottom",
                                "height": 36,
                                "store": "InfoLetterStore",
                                "width": 360
                            },
                            "name": "MyPagingToolbar26",
                            "designerId": "e00f23da-6335-45be-a4d8-4d84a0b6059b"
                        },
                        {
                            "type": "basiceventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onGridpanelCellClick",
                                "implHandler": [
                                    "if(cellIndex === undefined || cellIndex < 2) return;\r",
                                    "\r",
                                    "\r",
                                    "//var newArticleTab = Ext.widget('infoArtilceScanTab');\r",
                                    "\r",
                                    "\r",
                                    "\r",
                                    "var win = new Ext.Window({\r",
                                    "\r",
                                    "    title:'来信详细信息',\r",
                                    "    closable:true,\r",
                                    "    layout:'fit',\r",
                                    "    items:[\r",
                                    "    {\r",
                                    "        xtype: 'form',\r",
                                    "        height: 600,\r",
                                    "        layout: {\r",
                                    "            type: 'absolute'\r",
                                    "        },\r",
                                    "        id:'letterDetailForm',\r",
                                    "        jsonSubmit: true,\r",
                                    "        bodyPadding: 10,\r",
                                    "        items: [\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            hidden: true,\r",
                                    "            id: 'letterId',\r",
                                    "            name:'letterId',\r",
                                    "            width: 780,\r",
                                    "            fieldLabel: '来信主题',\r",
                                    "            labelWidth: 80\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            hidden: true,\r",
                                    "            id: 'letterIsreply',\r",
                                    "            name: 'letterIsreply',\r",
                                    "            width: 780,\r",
                                    "            fieldLabel: '来信主题',\r",
                                    "            labelWidth: 80\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            hidden: true,\r",
                                    "            id: 'letterReplytime',\r",
                                    "            name: 'letterReplytime',\r",
                                    "            width: 780,\r",
                                    "            fieldLabel: '来信主题',\r",
                                    "            labelWidth: 80\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            id: 'letterTitle',\r",
                                    "            name: 'letterTitle',\r",
                                    "            width: 780,\r",
                                    "            fieldLabel: '来信主题',\r",
                                    "            labelWidth: 80\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 10,\r",
                                    "            y: 40,\r",
                                    "            id: 'letterAuthor',\r",
                                    "            name: 'letterAuthor',\r",
                                    "            width: 230,\r",
                                    "            fieldLabel: '来信人姓名',\r",
                                    "            labelWidth: 80\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 260,\r",
                                    "            y: 70,\r",
                                    "            id: 'letterTel',\r",
                                    "            name: 'letterTel',\r",
                                    "            width: 230,\r",
                                    "            fieldLabel: '联系电话',\r",
                                    "            labelWidth: 80\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 510,\r",
                                    "            y: 70,\r",
                                    "            id: 'letterAddress',\r",
                                    "            name: 'letterAddress',\r",
                                    "            width: 280,\r",
                                    "            fieldLabel: '通讯地址',\r",
                                    "            labelWidth: 80\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 10,\r",
                                    "            y: 70,\r",
                                    "            id: 'letterAuthorcardid',\r",
                                    "            name: 'letterAuthorcardid',\r",
                                    "            width: 230,\r",
                                    "            fieldLabel: '身份证号',\r",
                                    "            labelWidth: 80\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 260,\r",
                                    "            y: 40,\r",
                                    "            id: 'letterEmail',\r",
                                    "            name: 'letterEmail',\r",
                                    "            width: 230,\r",
                                    "            fieldLabel: '电子邮件',\r",
                                    "            labelWidth: 80\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 510,\r",
                                    "            y: 40,\r",
                                    "            id: 'letterWritetime',\r",
                                    "            name: 'letterWritetime',\r",
                                    "            width: 230,\r",
                                    "            fieldLabel: '来信时间',\r",
                                    "            labelWidth: 80\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 10,\r",
                                    "            y: 100,\r",
                                    "            height: 180,\r",
                                    "            id: 'letterContent',\r",
                                    "            name: 'letterContent',\r",
                                    "            width: 780,\r",
                                    "            fieldLabel: '来信内容',\r",
                                    "            labelWidth: 80\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'textareafield',\r",
                                    "            x: 10,\r",
                                    "            y: 280,\r",
                                    "            height: 180,\r",
                                    "            id: 'letterReplycontent',\r",
                                    "            name: 'letterReplycontent',\r",
                                    "            width: 780,\r",
                                    "            fieldLabel: '回复内容',\r",
                                    "            labelWidth: 80\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'radiogroup',\r",
                                    "            x: 10,\r",
                                    "            y: 470,\r",
                                    "            id: 'letterIsshow',\r",
                                    "            fieldLabel: '是否公示：',\r",
                                    "            labelWidth: 80,\r",
                                    "            items: [\r",
                                    "            {\r",
                                    "                xtype: 'radiofield',\r",
                                    "                name: 'letterIsshow',\r",
                                    "                boxLabel: '是',\r",
                                    "                inputValue: '是'\r",
                                    "            },\r",
                                    "            {\r",
                                    "                xtype: 'radiofield',\r",
                                    "                name: 'letterIsshow',\r",
                                    "                boxLabel: '否',\r",
                                    "                inputValue: '否'\r",
                                    "            }\r",
                                    "            ]\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'button',\r",
                                    "            handler: function(button, event) {\r",
                                    "\r",
                                    "                var myform = Ext.getCmp('letterDetailForm').getForm();\r",
                                    "                if (myform.isValid()) { // make sure the form contains valid data before submitting\r",
                                    "                    myform.submit({\r",
                                    "                        url:'update_letter',\r",
                                    "                        success: function(form, action) {\r",
                                    "                            Ext.Msg.alert('成功', '成功回复');\r",
                                    "\r",
                                    "                            var mystore = Ext.StoreMgr.get('InfoLetterStore'); //获得store对象                                                   \r",
                                    "                            mystore.load();\r",
                                    "                            //{\r",
                                    "                            //params: {\r",
                                    "                            // start: \"0\",\r",
                                    "                            // limit: \"25\"\r",
                                    "                            //searchField: Ext.getCmp('searchField_pubNewDynamic').getValue(),\r",
                                    "                            //searchDate: Ext.util.Format.date(Ext.getCmp('searchDate_pubNewDynamic').getValue(), 'Y-m-d'); \r",
                                    "                            //}\r",
                                    "                            //}\r",
                                    "                            // );\r",
                                    "\r",
                                    "                            win.close();\r",
                                    "\r",
                                    "                        },\r",
                                    "                        failure: function(form, action) {\r",
                                    "                            Ext.Msg.alert('failure', '回复失败');                           \r",
                                    "                            win.close();\r",
                                    "                        }\r",
                                    "                    });\r",
                                    "                } else {\r",
                                    "                    Ext.Msg.alert('注意', '填写信息不能为空，请检查！');\r",
                                    "                }\r",
                                    "\r",
                                    "                return;\r",
                                    "\r",
                                    "\r",
                                    "\r",
                                    "\r",
                                    "\r",
                                    "\r",
                                    "            },\r",
                                    "            x: 10,\r",
                                    "            y: 510,\r",
                                    "            text: '回复并发送邮件'\r",
                                    "\r",
                                    "\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'button',\r",
                                    "            handler: function(button, event) {\r",
                                    "                win.close();\r",
                                    "            },\r",
                                    "            x: 160,\r",
                                    "            y: 510,\r",
                                    "            width: 90,\r",
                                    "            text: '取消'\r",
                                    "        }\r",
                                    "        ]\r",
                                    "    }\r",
                                    "\r",
                                    "    ]\r",
                                    "});\r",
                                    "\r",
                                    "\r",
                                    "Ext.getCmp('letterId').setValue(record.data.letterId);\r",
                                    "Ext.getCmp('letterTitle').setValue(record.data.letterTitle);\r",
                                    "Ext.getCmp('letterContent').setValue(record.data.letterContent);\r",
                                    "Ext.getCmp('letterAuthor').setValue(record.data.letterAuthor);\r",
                                    "Ext.getCmp('letterIsreply').setValue(record.data.letterIsreply);\r",
                                    "Ext.getCmp('letterIsshow').setValue({letterIsshow:record.data.letterIsshow});\r",
                                    "Ext.getCmp('letterReplycontent').setValue(record.data.letterReplycontent);\r",
                                    "Ext.getCmp('letterTel').setValue(record.data.letterTel);\r",
                                    "Ext.getCmp('letterEmail').setValue(record.data.letterEmail);\r",
                                    "Ext.getCmp('letterAddress').setValue(record.data.letterAddress);\r",
                                    "Ext.getCmp('letterWritetime').setValue(record.data.letterWritetime);\r",
                                    "Ext.getCmp('letterReplytime').setValue(record.data.letterReplytime);\r",
                                    "Ext.getCmp('letterAuthorcardid').setValue(record.data.articleIsrecycle);\r",
                                    "\r",
                                    "\r",
                                    "//var letterIsshow = Ext.getCmp('letterIsshow').getValue().inputValue;\r",
                                    "\r",
                                    "\r",
                                    "win.show();"
                                ],
                                "name": "cellclick",
                                "scope": "me"
                            },
                            "name": "onGridpanelCellClick",
                            "designerId": "f402cbd0-d74e-4131-b4cd-070e63b2bd36"
                        }
                    ]
                }
            ]
        }
    ]
}