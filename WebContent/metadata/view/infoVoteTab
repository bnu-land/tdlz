{
    "type": "Ext.panel.Panel",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userAlias": "infoVoteTab",
        "designer|userClassName": "infoVoteTab",
        "id": "infoVoteTab",
        "layout": "fit",
        "title": "监管>>网上投票"
    },
    "designerId": "5d2a7325-4be0-4691-8cc6-d22305d0c406",
    "cn": [
        {
            "type": "Ext.form.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "baseParams": null,
                "bodyPadding": 10,
                "id": "infoVoteForm",
                "layout": "border",
                "title": null
            },
            "name": "MyForm34",
            "designerId": "728aa1ee-7c2d-48f6-9774-21ac594cd5fa",
            "cn": [
                {
                    "type": "Ext.grid.Panel",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "forceFit": true,
                        "id": "infoVoteGrid",
                        "layout|region": "center",
                        "store": "InfoVoteStore",
                        "title": ""
                    },
                    "name": "MyGridPanel36",
                    "designerId": "d1a19c71-4bee-496e-a789-8e54f4ad5bd0",
                    "cn": [
                        {
                            "type": "Ext.grid.RowNumberer",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "name": "MyRowNumberer29",
                            "designerId": "9789df8a-349f-4195-953d-51329a418db8"
                        },
                        {
                            "type": "Ext.grid.column.Column",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "voteTitle",
                                "text": "主题"
                            },
                            "name": "MyColumn196",
                            "designerId": "3c577f39-f5a5-485c-9bef-6888d658d7f2"
                        },
                        {
                            "type": "Ext.grid.column.Column",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "voteVoter",
                                "text": "发起人"
                            },
                            "name": "MyColumn197",
                            "designerId": "8375e2a5-eb69-46a7-9651-692799a1afa9"
                        },
                        {
                            "type": "Ext.grid.column.Date",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "voteStarttime",
                                "format": "Y-m-d",
                                "text": "开始时间"
                            },
                            "name": "MyDateColumn33",
                            "designerId": "c36e84bc-53de-42e3-966f-6cff4cfb96e7"
                        },
                        {
                            "type": "Ext.grid.column.Date",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "voteEndtime",
                                "format": "Y-m-d",
                                "text": "结束时间"
                            },
                            "name": "MyDateColumn34",
                            "designerId": "e00af8f9-5963-4017-a40d-e915aca699b3"
                        },
                        {
                            "type": "Ext.grid.column.Column",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "voteState",
                                "text": "状态"
                            },
                            "name": "MyColumn198",
                            "designerId": "1c11de9d-b831-41e2-9404-74b6f498d0f1"
                        },
                        {
                            "type": "Ext.grid.column.Column",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "voteClass",
                                "text": "投票类型"
                            },
                            "name": "MyColumn199",
                            "designerId": "d68297b5-a1c4-46c0-acb3-125da995b662"
                        },
                        {
                            "type": "Ext.grid.View",
                            "reference": {
                                "name": "viewConfig",
                                "type": "object"
                            },
                            "codeClass": null,
                            "name": "MyGridView36",
                            "designerId": "1888e5db-583d-46c9-9aae-5f889594bc53"
                        },
                        {
                            "type": "Ext.toolbar.Toolbar",
                            "reference": {
                                "name": "dockedItems",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dock": "top",
                                "enableOverflow": true
                            },
                            "name": "MyToolbar50",
                            "designerId": "6ac10ac4-f977-4ca8-b3c6-1e72c1c431ca",
                            "cn": [
                                {
                                    "type": "Ext.form.field.Text",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "emptyText": "请输入搜索关键字",
                                        "fieldLabel": "",
                                        "id": "searchKeywordVote",
                                        "layout|flex": null,
                                        "width": 173
                                    },
                                    "name": "MyTextField201",
                                    "designerId": "d8620049-3fd7-4b36-bc56-caee66eae718"
                                },
                                {
                                    "type": "Ext.button.Button",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "icon": "images/file_view0.png",
                                        "layout|flex": null,
                                        "text": "搜索"
                                    },
                                    "name": "MyButton199",
                                    "designerId": "293e25fd-8381-423b-89d4-9210f2346ae7",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "button",
                                                    "event"
                                                ],
                                                "fn": "handler",
                                                "implHandler": [
                                                    "\r",
                                                    "var getKeyword = Ext.getCmp('searchKeywordVote').getValue();\r",
                                                    "var mystore=Ext.StoreMgr.get('InfoVoteStore'); //获得store对象\r",
                                                    "\r",
                                                    "\r",
                                                    "//在load事件中添加参数\r",
                                                    "//mystore.load(\r",
                                                    "//{params:{\r",
                                                    "//    start:\"0\",\r",
                                                    "//    limit:\"25\",\r",
                                                    "//    searchKeyword:getKeyword\r",
                                                    "//} \r",
                                                    "//}\r",
                                                    "//);\r",
                                                    "\r",
                                                    "\r",
                                                    "\r",
                                                    "mystore.on('beforeload',function(store,options){\r",
                                                    "\r",
                                                    "    var new_params = { \r",
                                                    "        searchKeyword:getKeyword\r",
                                                    "    };\r",
                                                    "\r",
                                                    "    Ext.apply(store.proxy.extraParams,new_params);\r",
                                                    "});\r",
                                                    "\r",
                                                    "mystore.load(\r",
                                                    "{\r",
                                                    "    params:{\r",
                                                    "        start:\"0\",\r",
                                                    "        limit:\"25\"\r",
                                                    "    }\r",
                                                    "}\r",
                                                    ");"
                                                ]
                                            },
                                            "name": "handler",
                                            "designerId": "b4cb5fc3-3f32-42ba-a0a8-db1267599939"
                                        }
                                    ]
                                },
                                {
                                    "type": "Ext.button.Button",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "icon": "images/table_add.png",
                                        "layout|flex": null,
                                        "text": "新建投票"
                                    },
                                    "name": "MyButton200",
                                    "designerId": "1812bfab-27f4-471b-a476-1009a5d25e4e",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "button",
                                                    "event"
                                                ],
                                                "fn": "handler",
                                                "implHandler": [
                                                    "//var newPanel = Ext.widget(\"infoVotePublishTab\");\r",
                                                    "\r",
                                                    "var getVoteoptionAddstore = Ext.StoreMgr.get('InfoVoteoptionAddStore');//获得store对象 \r",
                                                    "getVoteoptionAddstore.load({\r",
                                                    "    params:{voteId:0}\r",
                                                    "});\r",
                                                    "var win = new Ext.Window({\r",
                                                    "\r",
                                                    "    title: '新建投票',\r",
                                                    "    closable: true,\r",
                                                    "    layout: 'fit',\r",
                                                    "    jsonSubmit: true,\r",
                                                    "    items:[\r",
                                                    "\r",
                                                    "\r",
                                                    "    {\r",
                                                    "        xtype: 'form',\r",
                                                    "        id: 'infoVotePublishForm',\r",
                                                    "        layout: {\r",
                                                    "            type: 'absolute'\r",
                                                    "        },\r",
                                                    "        bodyPadding: 10,\r",
                                                    "        title: '',\r",
                                                    "        jsonSubmit: true,\r",
                                                    "        items: [\r",
                                                    "        {\r",
                                                    "            xtype: 'textfield',\r",
                                                    "            x: 40,\r",
                                                    "            y: 10,\r",
                                                    "            width: 690,\r",
                                                    "            fieldLabel: '投票主题',\r",
                                                    "            name: 'voteTitle'\r",
                                                    "        },\r",
                                                    "        {\r",
                                                    "            xtype: 'textfield',\r",
                                                    "            x: 40,\r",
                                                    "            y: 40,\r",
                                                    "            height: 100,\r",
                                                    "            width: 690,\r",
                                                    "            fieldLabel: '投票简介',\r",
                                                    "            name: 'voteIntroduction'\r",
                                                    "        },\r",
                                                    "        {\r",
                                                    "            xtype: 'textfield',\r",
                                                    "            x: 40,\r",
                                                    "            y: 150,\r",
                                                    "            width: 690,\r",
                                                    "            fieldLabel: '发起人',\r",
                                                    "            name: 'voteVoter'\r",
                                                    "        },\r",
                                                    "        {\r",
                                                    "            xtype: 'radiogroup',\r",
                                                    "            x: 40,\r",
                                                    "            y: 180,\r",
                                                    "            width: 320,\r",
                                                    "            fieldLabel: '投票类型',\r",
                                                    "            items: [\r",
                                                    "            {\r",
                                                    "                xtype: 'radiofield',\r",
                                                    "                name: 'voteClass',\r",
                                                    "                boxLabel: '单选',\r",
                                                    "                inputValue: '单选'\r",
                                                    "            },\r",
                                                    "            {\r",
                                                    "                xtype: 'radiofield',\r",
                                                    "                name: 'voteClass',\r",
                                                    "                boxLabel: '多选',\r",
                                                    "                inputValue: '多选'\r",
                                                    "            }\r",
                                                    "            ]\r",
                                                    "        },\r",
                                                    "        {\r",
                                                    "            xtype: 'datefield',\r",
                                                    "            x: 410,\r",
                                                    "            y: 180,\r",
                                                    "            width: 260,\r",
                                                    "            fieldLabel: '结束时间',\r",
                                                    "            name: 'voteEndtime',\r",
                                                    "            format: 'Y-m-d'\r",
                                                    "        },\r",
                                                    "        {\r",
                                                    "            xtype: 'gridpanel',\r",
                                                    "            x: 140,\r",
                                                    "            y: 210,\r",
                                                    "            height: 319,\r",
                                                    "            id: 'infoVoteoptionGrid',\r",
                                                    "            width: 590,\r",
                                                    "            title: '',\r",
                                                    "            store: getVoteoptionAddstore,\r",
                                                    "            columns: [\r",
                                                    "            {\r",
                                                    "                xtype: 'rownumberer'\r",
                                                    "            },\r",
                                                    "            {\r",
                                                    "                xtype: 'gridcolumn',\r",
                                                    "                dataIndex: 'voptionContent',\r",
                                                    "                text: '选项内容'\r",
                                                    "            }\r",
                                                    "            ],\r",
                                                    "            dockedItems: [\r",
                                                    "            {\r",
                                                    "                xtype: 'toolbar',\r",
                                                    "                dock: 'top',\r",
                                                    "                items: [\r",
                                                    "                {\r",
                                                    "                    xtype: 'button',\r",
                                                    "                    handler: function(button, event) {\r",
                                                    "                        //var voptionPanel = Ext.widget(\"infoVoteoptionShowTab\");\r",
                                                    "                        var voptionwin = new Ext.Window({\r",
                                                    "\r",
                                                    "                            title: '增加选项',\r",
                                                    "                            closable: true,\r",
                                                    "                            layout: 'fit',\r",
                                                    "                            jsonSubmit: true,\r",
                                                    "                            items:[\r",
                                                    "\r",
                                                    "                            {\r",
                                                    "                                xtype: 'form',\r",
                                                    "                                id: 'voptionForm',\r",
                                                    "                                layout: {\r",
                                                    "                                    type: 'auto'\r",
                                                    "                                },\r",
                                                    "                                bodyPadding: 10,\r",
                                                    "                                jsonSubmit: true,\r",
                                                    "                                title: '',\r",
                                                    "                                items: [\r",
                                                    "                                {\r",
                                                    "                                    xtype: 'textfield',\r",
                                                    "                                    id: 'voptionContent',\r",
                                                    "                                    width: 340,\r",
                                                    "                                    fieldLabel: '投票选项',\r",
                                                    "                                    name: 'voptionContent'\r",
                                                    "                                },\r",
                                                    "                                {\r",
                                                    "                                    xtype: 'button',\r",
                                                    "                                    handler: function(button, event) {\r",
                                                    "                                        var myform = Ext.getCmp('voptionForm').getForm();\r",
                                                    "\r",
                                                    "                                        if (myform.isValid()) { \r",
                                                    "                                            myform.submit({\r",
                                                    "                                                url:'add_voteoption',\r",
                                                    "                                                success: function(form, action) {\r",
                                                    "                                                    Ext.Msg.alert('成功', '增加选项成功');\r",
                                                    "\r",
                                                    "                                                    getVoteoptionAddstore.load();\r",
                                                    "                                                    voptionwin.close();\r",
                                                    "\r",
                                                    "                                                },\r",
                                                    "                                                failure: function(form, action) {\r",
                                                    "                                                    Ext.Msg.alert('失败', '修改内容失败');              \r",
                                                    "                                                    voptionwin.close();\r",
                                                    "                                                }\r",
                                                    "                                            });\r",
                                                    "                                        } else {\r",
                                                    "                                            Ext.Msg.alert('注意', '填写信息不能为空，请检查！');\r",
                                                    "                                        }\r",
                                                    "\r",
                                                    "                                        return;\r",
                                                    "                                    },\r",
                                                    "                                    text: '确定'\r",
                                                    "                                }\r",
                                                    "                                ]\r",
                                                    "                            }\r",
                                                    "\r",
                                                    "\r",
                                                    "\r",
                                                    "                            ]    \r",
                                                    "                        });\r",
                                                    "                        voptionwin.show();\r",
                                                    "                    },\r",
                                                    "                    text: '增加选项'\r",
                                                    "                },\r",
                                                    "                {\r",
                                                    "                    xtype: 'button',\r",
                                                    "                    handler: function(button, event) {\r",
                                                    "                        var grid = Ext.getCmp('infoVoteoptionGrid');\r",
                                                    "\r",
                                                    "                        var record = grid.getSelectionModel().getSelection();\r",
                                                    "\r",
                                                    "                        if(record.length === 0){\r",
                                                    "                            Ext.Msg.alert('提示','请先选择您要操作的行！');    \r",
                                                    "                            return;\r",
                                                    "\r",
                                                    "                        }else{\r",
                                                    "\r",
                                                    "\r",
                                                    "                            var  voptionIds =new Array(record.length);\r",
                                                    "                            for(var i = 0;i<record.length;i++){\r",
                                                    "                                voptionIds[i] = record[i].get(\"voptionId\");\r",
                                                    "\r",
                                                    "                            }\r",
                                                    "\r",
                                                    "\r",
                                                    "                            Ext.Ajax.request({\r",
                                                    "                                url:'del_voptionIds',\r",
                                                    "                                params:{voptionIds:voptionIds},\r",
                                                    "\r",
                                                    "                                success:function(response){\r",
                                                    "                                    Ext.Msg.alert('成功','删除成功');\r",
                                                    "                                    var mystore = Ext.StoreMgr.get('InfoVoteoptionAddStore');\r",
                                                    "                                    mystore.load();\r",
                                                    "\r",
                                                    "                                }\r",
                                                    "\r",
                                                    "                            });\r",
                                                    "\r",
                                                    "                        }\r",
                                                    "                    },\r",
                                                    "                    text: '删除选项'\r",
                                                    "                }\r",
                                                    "                ]\r",
                                                    "            }\r",
                                                    "            ],\r",
                                                    "            selModel: Ext.create('Ext.selection.CheckboxModel', {\r",
                                                    "\r",
                                                    "            })\r",
                                                    "        },\r",
                                                    "        {\r",
                                                    "            xtype: 'button',\r",
                                                    "            handler: function(button, event) {\r",
                                                    "                var myform = Ext.getCmp('infoVotePublishForm').getForm();\r",
                                                    "\r",
                                                    "                if (myform.isValid()) { \r",
                                                    "                    myform.submit({\r",
                                                    "                        url:'add_vote',\r",
                                                    "                        success: function(form, action) {\r",
                                                    "                            Ext.Msg.alert('成功', '投票新建成功');\r",
                                                    "\r",
                                                    "                            var mystore = Ext.StoreMgr.get('InfoVoteStore'); //获得store对象  \r",
                                                    "\r",
                                                    "                            mystore.load();\r",
                                                    "                            win.close();\r",
                                                    "\r",
                                                    "\r",
                                                    "                        },\r",
                                                    "                        failure: function(form, action) {\r",
                                                    "                            Ext.Msg.alert('失败', '修改内容失败');              \r",
                                                    "\r",
                                                    "                        }\r",
                                                    "                    });\r",
                                                    "                } else {\r",
                                                    "                    Ext.Msg.alert('注意', '填写信息不能为空，请检查！');\r",
                                                    "                }\r",
                                                    "\r",
                                                    "                return;\r",
                                                    "            },\r",
                                                    "            x: 170,\r",
                                                    "            y: 540,\r",
                                                    "            text: '确定发起投票'\r",
                                                    "        },\r",
                                                    "        {\r",
                                                    "            xtype: 'button',\r",
                                                    "            x: 380,\r",
                                                    "            y: 540,\r",
                                                    "            width: 80,\r",
                                                    "            text: '重置'\r",
                                                    "        }\r",
                                                    "        ]\r",
                                                    "    }\r",
                                                    "\r",
                                                    "\r",
                                                    "\r",
                                                    "\r",
                                                    "    ]    \r",
                                                    "});\r",
                                                    "win.show();"
                                                ]
                                            },
                                            "name": "handler",
                                            "designerId": "32e189e6-68d3-4e4a-bf04-cd8a5284833c"
                                        }
                                    ]
                                },
                                {
                                    "type": "Ext.button.Button",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "icon": "images/table_add.png",
                                        "layout|flex": null,
                                        "text": "启动投票"
                                    },
                                    "name": "MyButton201",
                                    "designerId": "e050e8d0-0fcf-4d29-8a4f-628ebf356520",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "button",
                                                    "event"
                                                ],
                                                "fn": "handler",
                                                "implHandler": [
                                                    "var grid = Ext.getCmp('infoVoteGrid');\r",
                                                    "var record = grid.getSelectionModel().getSelection();\r",
                                                    "\r",
                                                    "if(record.length != 1 || record[0].get(\"voteState\")!= '待发布'){\r",
                                                    "    Ext.Msg.alert('提示','请选择一个待发布的投票！');    \r",
                                                    "    return;\r",
                                                    "\r",
                                                    "}else{\r",
                                                    "\r",
                                                    "\r",
                                                    "    Ext.Ajax.request({\r",
                                                    "        url:'update_voteStateTo2',\r",
                                                    "        params:{voteIds:record[0].get(\"voteId\")},\r",
                                                    "\r",
                                                    "        success:function(response){\r",
                                                    "            Ext.Msg.alert('成功','投票开始');\r",
                                                    "            var mystore = Ext.StoreMgr.get('InfoVoteStore');\r",
                                                    "            mystore.load();         \r",
                                                    "\r",
                                                    "        }\r",
                                                    "\r",
                                                    "    });\r",
                                                    "}\r",
                                                    ""
                                                ]
                                            },
                                            "name": "handler",
                                            "designerId": "34620ca7-b976-43f3-8ef7-bac7f9a2d7b2"
                                        }
                                    ]
                                },
                                {
                                    "type": "Ext.button.Button",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "icon": "images/table_add.png",
                                        "layout|flex": null,
                                        "text": "停止投票"
                                    },
                                    "name": "MyButton202",
                                    "designerId": "ca7eeba7-998d-4f2d-a87b-625487d16bdf",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "button",
                                                    "event"
                                                ],
                                                "fn": "handler",
                                                "implHandler": [
                                                    "var grid = Ext.getCmp('infoVoteGrid');\r",
                                                    "var record = grid.getSelectionModel().getSelection();\r",
                                                    "\r",
                                                    "if(record.length != 1 || record[0].get(\"voteState\")!= '正在进行'){\r",
                                                    "    Ext.Msg.alert('提示','请选择一个正在进行的投票！');    \r",
                                                    "    return;\r",
                                                    "\r",
                                                    "}else{\r",
                                                    "\r",
                                                    "\r",
                                                    "    Ext.Ajax.request({\r",
                                                    "        url:'update_voteStateTo3',\r",
                                                    "        params:{voteIds:record[0].get(\"voteId\")},\r",
                                                    "\r",
                                                    "        success:function(response){\r",
                                                    "            Ext.Msg.alert('成功','投票已停止');\r",
                                                    "            var mystore = Ext.StoreMgr.get('InfoVoteStore');\r",
                                                    "            mystore.load();         \r",
                                                    "\r",
                                                    "        }\r",
                                                    "\r",
                                                    "    });\r",
                                                    "}\r",
                                                    ""
                                                ]
                                            },
                                            "name": "handler",
                                            "designerId": "5b8da538-7dc5-4df1-8f43-3eda1f7268e8"
                                        }
                                    ]
                                },
                                {
                                    "type": "Ext.button.Button",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "icon": "images/table_delete.png",
                                        "layout|flex": null,
                                        "text": "修改投票"
                                    },
                                    "name": "MyButton203",
                                    "designerId": "e9a94bb2-9235-464c-a20f-c77097d316e3",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "button",
                                                    "event"
                                                ],
                                                "fn": "handler",
                                                "implHandler": [
                                                    "var grid = Ext.getCmp('infoVoteGrid');\r",
                                                    "\r",
                                                    "var record = grid.getSelectionModel().getSelection();\r",
                                                    "\r",
                                                    "\r",
                                                    "\r",
                                                    "\r",
                                                    "if(record.length != 1||record[0].get(\"voteState\") == '正在进行'){\r",
                                                    "    Ext.Msg.alert('提示','请选择一条未发布或已停止的投票');    \r",
                                                    "    return;\r",
                                                    "\r",
                                                    "}else{\r",
                                                    "\r",
                                                    "    var getVoteId = record[0].data.voteId;\r",
                                                    "    var voteOptionStore = Ext.StoreMgr.get('InfoVoteoptionUpdateStore');\r",
                                                    "    voteOptionStore.load(\r",
                                                    "    {\r",
                                                    "        params:{voteId:getVoteId} \r",
                                                    "    }\r",
                                                    "    );\r",
                                                    "    //var newPanel = Ext.widget(\"infoVoteUpdateTab\");\r",
                                                    "    //Ext.Msg.alert('提示',record[0].data.voteId);   \r",
                                                    "\r",
                                                    "    var win = new Ext.Window({\r",
                                                    "\r",
                                                    "        title: '修改投票',\r",
                                                    "        closable: true,\r",
                                                    "        layout: 'fit',\r",
                                                    "        jsonSubmit: true,\r",
                                                    "        params:{voteId:record[0].data.voteId},\r",
                                                    "        items:[\r",
                                                    "\r",
                                                    "        {\r",
                                                    "            xtype: 'form',\r",
                                                    "            id: 'infoVoteUpdateForm',\r",
                                                    "            layout: {\r",
                                                    "                type: 'absolute'\r",
                                                    "            },\r",
                                                    "            bodyPadding: 10,\r",
                                                    "            title: '',\r",
                                                    "            baseParams: {\r",
                                                    "                voteId: ''\r",
                                                    "            },\r",
                                                    "            jsonSubmit: true,\r",
                                                    "            items: [\r",
                                                    "            {\r",
                                                    "                xtype: 'textfield',\r",
                                                    "                x: 40,\r",
                                                    "                y: 10,\r",
                                                    "                width: 690,\r",
                                                    "                hidden: true,\r",
                                                    "                fieldLabel: '投票Id',\r",
                                                    "                id: 'voteId',\r",
                                                    "                name: 'voteId'\r",
                                                    "            },\r",
                                                    "            {\r",
                                                    "                xtype: 'textfield',\r",
                                                    "                x: 40,\r",
                                                    "                y: 10,                \r",
                                                    "                width: 690,\r",
                                                    "                fieldLabel: '投票主题',\r",
                                                    "                id: 'voteTitle',\r",
                                                    "                name: 'voteTitle'\r",
                                                    "            },\r",
                                                    "            {\r",
                                                    "                xtype: 'textfield',\r",
                                                    "                x: 40,\r",
                                                    "                y: 40,\r",
                                                    "                height: 100,\r",
                                                    "                width: 690,\r",
                                                    "                fieldLabel: '投票简介',\r",
                                                    "                id: 'voteIntroduction',\r",
                                                    "                name: 'voteIntroduction'\r",
                                                    "            },\r",
                                                    "            {\r",
                                                    "                xtype: 'textfield',\r",
                                                    "                x: 40,\r",
                                                    "                y: 150,\r",
                                                    "                width: 690,\r",
                                                    "                fieldLabel: '发起人',\r",
                                                    "                id: 'voteVoter',\r",
                                                    "                name: 'voteVoter'\r",
                                                    "            },\r",
                                                    "            {\r",
                                                    "                xtype: 'radiogroup',\r",
                                                    "                x: 40,\r",
                                                    "                y: 180,\r",
                                                    "                width: 210,\r",
                                                    "                fieldLabel: '投票类型',\r",
                                                    "                id: 'voteClass',\r",
                                                    "                items: [\r",
                                                    "                {\r",
                                                    "                    xtype: 'radiofield',\r",
                                                    "                    name: 'voteClass',\r",
                                                    "                    boxLabel: '单选',\r",
                                                    "                    inputValue: '单选'\r",
                                                    "                },\r",
                                                    "                {\r",
                                                    "                    xtype: 'radiofield',\r",
                                                    "                    name: 'voteClass',\r",
                                                    "                    boxLabel: '多选',\r",
                                                    "                    inputValue: '多选'\r",
                                                    "                }\r",
                                                    "                ]\r",
                                                    "            },\r",
                                                    "            {\r",
                                                    "                xtype: 'displayfield',\r",
                                                    "                x: 270,\r",
                                                    "                y: 180,\r",
                                                    "                width: 220,\r",
                                                    "                fieldLabel: '开始时间',\r",
                                                    "                id: 'voteStarttime',\r",
                                                    "                name: 'voteStarttime'\r",
                                                    "            },\r",
                                                    "            {\r",
                                                    "                xtype: 'datefield',\r",
                                                    "                x: 500,\r",
                                                    "                y: 180,\r",
                                                    "                width: 220,\r",
                                                    "                fieldLabel: '结束时间',\r",
                                                    "                id: 'voteEndtime',\r",
                                                    "                name: 'voteEndtime',\r",
                                                    "                format: 'Y-m-d'\r",
                                                    "            },\r",
                                                    "            {\r",
                                                    "                xtype: 'gridpanel',\r",
                                                    "                x: 140,\r",
                                                    "                y: 210,\r",
                                                    "                height: 319,\r",
                                                    "                id: 'infoVoteoptionGrid1',\r",
                                                    "                width: 590,\r",
                                                    "                title: '',\r",
                                                    "                store: voteOptionStore,\r",
                                                    "                columns: [\r",
                                                    "                {\r",
                                                    "                    xtype: 'rownumberer'\r",
                                                    "                },\r",
                                                    "                {\r",
                                                    "                    xtype: 'gridcolumn',\r",
                                                    "                    dataIndex: 'voptionContent',\r",
                                                    "                    text: '选项内容'\r",
                                                    "                },\r",
                                                    "                {\r",
                                                    "                    xtype: 'gridcolumn',\r",
                                                    "                    dataIndex: 'voptionNumber',\r",
                                                    "                    text: '投票数目'\r",
                                                    "                }\r",
                                                    "                ],\r",
                                                    "                dockedItems: [\r",
                                                    "                {\r",
                                                    "                    xtype: 'toolbar',\r",
                                                    "                    dock: 'top',\r",
                                                    "                    items: [\r",
                                                    "                    {\r",
                                                    "                        xtype: 'button',\r",
                                                    "                        handler: function(button, event) {\r",
                                                    "                            var voptionPanel = Ext.widget(\"infoVoteoptionShowTab\");\r",
                                                    "                            var voptionwin = new Ext.Window({\r",
                                                    "\r",
                                                    "                                title: '增加选项',\r",
                                                    "                                closable: true,\r",
                                                    "                                layout: 'fit',\r",
                                                    "                                jsonSubmit: true,\r",
                                                    "                                items:[\r",
                                                    "\r",
                                                    "                                {\r",
                                                    "                                    xtype: 'form',\r",
                                                    "                                    id: 'voptionForm',\r",
                                                    "                                    layout: {\r",
                                                    "                                        type: 'auto'\r",
                                                    "                                    },\r",
                                                    "                                    bodyPadding: 10,\r",
                                                    "                                    jsonSubmit: true,\r",
                                                    "                                    title: '',\r",
                                                    "                                    items: [\r",
                                                    "                                    {\r",
                                                    "                                        xtype: 'textfield',\r",
                                                    "                                        id: 'voptionContent',\r",
                                                    "                                        width: 340,\r",
                                                    "                                        fieldLabel: '投票选项',\r",
                                                    "                                        name: 'voptionContent'\r",
                                                    "                                    },\r",
                                                    "                                    {\r",
                                                    "                                        xtype: 'button',\r",
                                                    "                                        handler: function(button, event) {\r",
                                                    "                                            var myform = Ext.getCmp('voptionForm').getForm();\r",
                                                    "\r",
                                                    "                                            if (myform.isValid()) { \r",
                                                    "                                                myform.submit({\r",
                                                    "                                                    url:'add_voteoption2',\r",
                                                    "                                                    params:{voteId:getVoteId},\r",
                                                    "                                                    success: function(form, action) {\r",
                                                    "                                                        Ext.Msg.alert('成功', '增加选项成功');\r",
                                                    "\r",
                                                    "                                                        voteOptionStore.load({\r",
                                                    "                                                            params:{voteId:getVoteId} \r",
                                                    "                                                        });\r",
                                                    "                                                        voptionwin.close();\r",
                                                    "\r",
                                                    "                                                    },\r",
                                                    "                                                    failure: function(form, action) {\r",
                                                    "                                                        Ext.Msg.alert('失败', '修改内容失败');              \r",
                                                    "                                                        voptionwin.close();\r",
                                                    "                                                    }\r",
                                                    "                                                });\r",
                                                    "                                            } else {\r",
                                                    "                                                Ext.Msg.alert('注意', '填写信息不能为空，请检查！');\r",
                                                    "                                            }\r",
                                                    "\r",
                                                    "                                            return;\r",
                                                    "                                        },\r",
                                                    "                                        text: '确定'\r",
                                                    "                                    }\r",
                                                    "                                    ]\r",
                                                    "                                }\r",
                                                    "\r",
                                                    "\r",
                                                    "\r",
                                                    "                                ]    \r",
                                                    "                            });\r",
                                                    "                            voptionwin.show();\r",
                                                    "                        },\r",
                                                    "                        text: '增加选项'\r",
                                                    "                    },\r",
                                                    "                    {\r",
                                                    "                        xtype: 'button',\r",
                                                    "                        handler: function(button, event) {\r",
                                                    "                            var grid = Ext.getCmp('infoVoteoptionGrid1');\r",
                                                    "\r",
                                                    "                            var voptionrecord = grid.getSelectionModel().getSelection();\r",
                                                    "\r",
                                                    "                            if(voptionrecord.length === 0){\r",
                                                    "                                Ext.Msg.alert('提示','请先选择您要操作的行！');    \r",
                                                    "                                return;\r",
                                                    "\r",
                                                    "                            }else{\r",
                                                    "\r",
                                                    "\r",
                                                    "                                var  voptionIds =new Array(voptionrecord.length);\r",
                                                    "                                for(var i = 0;i<voptionrecord.length;i++){\r",
                                                    "                                    voptionIds[i] = voptionrecord[i].get(\"voptionId\");\r",
                                                    "\r",
                                                    "                                }\r",
                                                    "\r",
                                                    "\r",
                                                    "                                Ext.Ajax.request({\r",
                                                    "                                    url:'del_voptionIds',\r",
                                                    "                                    params:{voptionIds:voptionIds},\r",
                                                    "\r",
                                                    "                                    success:function(response){\r",
                                                    "                                        Ext.Msg.alert('成功','删除成功');\r",
                                                    "                                        voteOptionStore.load({\r",
                                                    "                                            params:{voteId:getVoteId} \r",
                                                    "                                        });\r",
                                                    "\r",
                                                    "                                    }\r",
                                                    "\r",
                                                    "                                });\r",
                                                    "\r",
                                                    "                            }\r",
                                                    "                        },\r",
                                                    "                        text: '删除选项'\r",
                                                    "                    }\r",
                                                    "                    ]\r",
                                                    "                }\r",
                                                    "                ],\r",
                                                    "                selModel: Ext.create('Ext.selection.CheckboxModel', {\r",
                                                    "\r",
                                                    "                })\r",
                                                    "            },\r",
                                                    "            {\r",
                                                    "                xtype: 'button',\r",
                                                    "                handler: function(button, event) {\r",
                                                    "                    var myform = Ext.getCmp('infoVoteUpdateForm').getForm();\r",
                                                    "\r",
                                                    "                    if (myform.isValid()) { \r",
                                                    "                        myform.submit({\r",
                                                    "                            url:'add_vote',\r",
                                                    "                            success: function(form, action) {\r",
                                                    "                                Ext.Msg.alert('成功', '修改成功');\r",
                                                    "\r",
                                                    "                                var mystore = Ext.StoreMgr.get('InfoVoteStore'); //获得store对象  \r",
                                                    "\r",
                                                    "                                mystore.load();\r",
                                                    "                                win.close();\r",
                                                    "\r",
                                                    "\r",
                                                    "                            },\r",
                                                    "                            failure: function(form, action) {\r",
                                                    "                                Ext.Msg.alert('失败', '修改内容失败');              \r",
                                                    "\r",
                                                    "                            }\r",
                                                    "                        });\r",
                                                    "                    } else {\r",
                                                    "                        Ext.Msg.alert('注意', '填写信息不能为空，请检查！');\r",
                                                    "                    }\r",
                                                    "\r",
                                                    "                    return;\r",
                                                    "                },\r",
                                                    "                x: 170,\r",
                                                    "                y: 540,\r",
                                                    "                text: '确定修改'\r",
                                                    "            },\r",
                                                    "            {\r",
                                                    "                xtype: 'button',\r",
                                                    "                hander:function(button, event) {\r",
                                                    "                    win.close(); \r",
                                                    "                },\r",
                                                    "                x: 380,\r",
                                                    "                y: 540,\r",
                                                    "                width: 80,\r",
                                                    "                text: '取消'\r",
                                                    "\r",
                                                    "            }\r",
                                                    "            ]\r",
                                                    "        }\r",
                                                    "\r",
                                                    "\r",
                                                    "        ]    \r",
                                                    "    });\r",
                                                    "\r",
                                                    "\r",
                                                    "    Ext.getCmp('voteId').setValue(record[0].data.voteId);\r",
                                                    "    Ext.getCmp('voteVoter').setValue(record[0].data.voteVoter);\r",
                                                    "    Ext.getCmp('voteTitle').setValue(record[0].data.voteTitle);\r",
                                                    "    Ext.getCmp('voteIntroduction').setValue(record[0].data.voteIntroduction);\r",
                                                    "    Ext.getCmp('voteStarttime').setValue(record[0].data.voteStarttime);\r",
                                                    "    Ext.getCmp('voteEndtime').setValue(record[0].data.voteEndtime);\r",
                                                    "    Ext.getCmp('voteClass').setValue({voteClass:record[0].data.voteClass});\r",
                                                    "    //Ext.getCmp('voteState').setValue(record[0].data.voteState);\r",
                                                    "    win.show();\r",
                                                    "\r",
                                                    "\r",
                                                    "}\r",
                                                    "\r",
                                                    "\r",
                                                    ""
                                                ]
                                            },
                                            "name": "handler",
                                            "designerId": "d1309ca0-5f7c-497e-b141-62cf0e8481b7"
                                        }
                                    ]
                                },
                                {
                                    "type": "Ext.button.Button",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "icon": "images/table_delete.png",
                                        "layout|flex": null,
                                        "text": "删除投票"
                                    },
                                    "name": "MyButton204",
                                    "designerId": "12aa466e-3178-4b96-83a2-2bf70acec371",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "button",
                                                    "event"
                                                ],
                                                "fn": "handler",
                                                "implHandler": [
                                                    "var grid = Ext.getCmp('infoVoteGrid');\r",
                                                    "\r",
                                                    "var record = grid.getSelectionModel().getSelection();\r",
                                                    "\r",
                                                    "if(record.length === 0){\r",
                                                    "    Ext.Msg.alert('提示','请先选择您要操作的行！');    \r",
                                                    "    return;\r",
                                                    "\r",
                                                    "}else{\r",
                                                    "\r",
                                                    "    var  voteIds =new Array(record.length);\r",
                                                    "    for(var i = 0;i<record.length;i++){\r",
                                                    "        voteIds[i] = record[i].get(\"voteId\");\r",
                                                    "\r",
                                                    "    }\r",
                                                    "\r",
                                                    "\r",
                                                    "\r",
                                                    "\r",
                                                    "    Ext.Ajax.request({\r",
                                                    "        url:'del_voteByIds',\r",
                                                    "        params:{voteIds:voteIds},\r",
                                                    "\r",
                                                    "        success:function(response){\r",
                                                    "            Ext.Msg.alert('成功','投票已删除');\r",
                                                    "            var mystore = Ext.StoreMgr.get('InfoVoteStore');\r",
                                                    "            mystore.load();\r",
                                                    "\r",
                                                    "\r",
                                                    "        }\r",
                                                    "\r",
                                                    "    });\r",
                                                    "\r",
                                                    "}"
                                                ]
                                            },
                                            "name": "handler",
                                            "designerId": "829ec490-5336-4e38-82e1-5d2af2abb837"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "Ext.toolbar.Paging",
                            "reference": {
                                "name": "dockedItems",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "displayInfo": true,
                                "dock": "bottom",
                                "store": "InfoVoteStore",
                                "width": 360
                            },
                            "name": "MyPagingToolbar24",
                            "designerId": "5f74fbe5-8fdf-4b9c-b6d4-2ea85aee3392"
                        },
                        {
                            "type": "Ext.selection.CheckboxModel",
                            "reference": {
                                "name": "selModel",
                                "type": "object"
                            },
                            "codeClass": "Ext.selection.CheckboxModel",
                            "name": "MyCheckboxSelectionModel28",
                            "designerId": "89404457-d8b8-4e51-a6e2-c40059f1af48"
                        },
                        {
                            "type": "basiceventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onGridpanelCellClick",
                                "implHandler": [
                                    "if(cellIndex === undefined || cellIndex < 2) return;\r",
                                    "\r",
                                    "var getVoteId = record.data.voteId;\r",
                                    "var voteOptionStore = Ext.StoreMgr.get('InfoVoteoptionStore');\r",
                                    "voteOptionStore.load(\r",
                                    "{\r",
                                    "    params:{voteId:getVoteId} \r",
                                    "}\r",
                                    ");\r",
                                    "\r",
                                    "var win = new Ext.Window({\r",
                                    "\r",
                                    "    title: '查看投票信息',\r",
                                    "    closable: true,\r",
                                    "    layout: 'fit',\r",
                                    "    jsonSubmit: true,\r",
                                    "    items:[\r",
                                    "\r",
                                    "    {\r",
                                    "        xtype: 'form',\r",
                                    "        layout: {\r",
                                    "            type: 'absolute'\r",
                                    "        },\r",
                                    "        bodyPadding: 10,\r",
                                    "        title: '',\r",
                                    "        items: [\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 40,\r",
                                    "            y: 10,\r",
                                    "            id: 'voteId',\r",
                                    "            width: 690,\r",
                                    "            fieldLabel: '投票id',\r",
                                    "            hidden:true,\r",
                                    "            name: 'voteId'\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 40,\r",
                                    "            y: 10,\r",
                                    "            id: 'voteTitle',\r",
                                    "            width: 690,\r",
                                    "            fieldLabel: '投票主题',\r",
                                    "            name: 'voteTitle'\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 40,\r",
                                    "            y: 40,\r",
                                    "            height: 100,\r",
                                    "            id: 'voteIntroduction',\r",
                                    "            width: 690,\r",
                                    "            fieldLabel: '投票简介',\r",
                                    "            name: 'voteIntroduction'\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 40,\r",
                                    "            y: 150,\r",
                                    "            id: 'voteVoter',\r",
                                    "            width: 690,\r",
                                    "            fieldLabel: '发起人',\r",
                                    "            name: 'voteVoter'\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 40,\r",
                                    "            y: 180,\r",
                                    "            id: 'voteStarttime',\r",
                                    "            width: 260,\r",
                                    "            fieldLabel: '开始时间',\r",
                                    "            name: 'voteStarttime'\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 410,\r",
                                    "            y: 180,\r",
                                    "            id: 'voteEndtime',\r",
                                    "            width: 260,\r",
                                    "            fieldLabel: '结束时间',\r",
                                    "            name: 'voteEndtime'\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 40,\r",
                                    "            y: 210,\r",
                                    "            id: 'voteClass',\r",
                                    "            width: 260,\r",
                                    "            fieldLabel: '投票类型',\r",
                                    "            name: 'voteClass'\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 410,\r",
                                    "            y: 220,\r",
                                    "            id: 'voteState',\r",
                                    "            width: 260,\r",
                                    "            fieldLabel: '投票状态',\r",
                                    "            name: 'voteState'\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'displayfield',\r",
                                    "            x: 40,\r",
                                    "            y: 240,\r",
                                    "            width: 105,\r",
                                    "            fieldLabel: '投票结果'\r",
                                    "        },\r",
                                    "        {\r",
                                    "            xtype: 'chart',\r",
                                    "            x: 110,\r",
                                    "            y: 260,\r",
                                    "            height: 250,\r",
                                    "            width: 400,\r",
                                    "            animate: true,\r",
                                    "            insetPadding: 20,\r",
                                    "            store: voteOptionStore,\r",
                                    "            axes: [\r",
                                    "            {\r",
                                    "                type: 'Category',\r",
                                    "                fields: [\r",
                                    "                'voptionContent'\r",
                                    "                ],\r",
                                    "                position: 'left',\r",
                                    "                title: '投票选项'\r",
                                    "            },\r",
                                    "            {\r",
                                    "                type: 'Numeric',\r",
                                    "                fields: [\r",
                                    "                'voptionNumber'\r",
                                    "                ],\r",
                                    "                position: 'bottom',\r",
                                    "                title: '投票数量'\r",
                                    "            }\r",
                                    "            ],\r",
                                    "            series: [\r",
                                    "            {\r",
                                    "                type: 'bar',\r",
                                    "                label: {\r",
                                    "                    display: 'insideEnd',\r",
                                    "                    field: 'voptionNumber',\r",
                                    "                    color: '#333',\r",
                                    "                    'text-anchor': 'middle'\r",
                                    "                },\r",
                                    "                axis: 'bottom',\r",
                                    "                xField: 'voptionContent',\r",
                                    "                yField: 'voptionNumber'\r",
                                    "            }\r",
                                    "            ]\r",
                                    "        }\r",
                                    "        ]\r",
                                    "    }\r",
                                    "\r",
                                    "\r",
                                    "    ]    \r",
                                    "});\r",
                                    "\r",
                                    "Ext.getCmp('voteId').setValue(record.data.voteId);\r",
                                    "Ext.getCmp('voteVoter').setValue(record.data.voteVoter);\r",
                                    "Ext.getCmp('voteTitle').setValue(record.data.voteTitle);\r",
                                    "Ext.getCmp('voteIntroduction').setValue(record.data.voteIntroduction);\r",
                                    "Ext.getCmp('voteStarttime').setValue(record.data.voteStarttime);\r",
                                    "Ext.getCmp('voteEndtime').setValue(record.data.voteEndtime);\r",
                                    "Ext.getCmp('voteClass').setValue(record.data.voteClass);\r",
                                    "Ext.getCmp('voteState').setValue(record.data.voteState);\r",
                                    "win.show();\r",
                                    "\r",
                                    "\r",
                                    "\r",
                                    ""
                                ],
                                "name": "cellclick",
                                "scope": "me"
                            },
                            "name": "onGridpanelCellClick",
                            "designerId": "14ec5d89-8406-4864-80ae-90051a50b8b5"
                        }
                    ]
                }
            ]
        }
    ]
}