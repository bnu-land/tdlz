/*
 * File: app/view/infoArticleBSZNTab.js
 *
 * This file was generated by Sencha Architect version 3.1.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.view.infoArticleBSZNTab', {
    extend: 'Ext.panel.Panel',
    alias: 'widget.infoArticleBSZNTab',

    requires: [
        'Ext.tab.Panel',
        'Ext.tab.Tab',
        'Ext.grid.Panel',
        'Ext.grid.RowNumberer',
        'Ext.grid.column.Date',
        'Ext.grid.View',
        'Ext.selection.CheckboxModel',
        'Ext.form.field.Date',
        'Ext.toolbar.Paging'
    ],

    id: 'infoArticleBSZNTab',
    layout: 'fit',
    title: '信息管理与发布>>办事指南',

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'tabpanel',
                    height: 421,
                    id: '',
                    bodyPadding: 10,
                    items: [
                        {
                            xtype: 'panel',
                            layout: 'fit',
                            title: '已发布',
                            items: [
                                {
                                    xtype: 'gridpanel',
                                    id: 'articlePubGrid13',
                                    collapsible: false,
                                    title: '',
                                    forceFit: true,
                                    store: 'ArticlePubBSZNStore',
                                    columns: [
                                        {
                                            xtype: 'rownumberer',
                                            width: 47,
                                            text: '记录号'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'articleName',
                                            text: '信息标题',
                                            tooltip: '点击查看详细信息'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'articleAuthor',
                                            text: '作者'
                                        },
                                        {
                                            xtype: 'datecolumn',
                                            dataIndex: 'articlePublishtime',
                                            text: '发布时间',
                                            format: 'Y-m-d'
                                        }
                                    ],
                                    selModel: Ext.create('Ext.selection.CheckboxModel', {

                                    }),
                                    dockedItems: [
                                        {
                                            xtype: 'toolbar',
                                            dock: 'top',
                                            frame: false,
                                            enableOverflow: true,
                                            items: [
                                                {
                                                    xtype: 'datefield',
                                                    id: 'searchDatePub13',
                                                    width: 204,
                                                    fieldLabel: '起始时间',
                                                    labelWidth: 70,
                                                    format: 'Y-m-d'
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    id: 'searchKeywordPub13',
                                                    width: 211,
                                                    fieldLabel: '',
                                                    labelWidth: 50,
                                                    emptyText: '请输入搜索关键字'
                                                },
                                                {
                                                    xtype: 'button',
                                                    handler: function(button, event) {
                                                        var getDate = Ext.util.Format.date(Ext.getCmp('searchDatePub13').getValue(),'Y-m-d');
                                                        var getKeyword = Ext.getCmp('searchKeywordPub13').getValue();
                                                        var mystore=Ext.StoreMgr.get('ArticlePubBSZNStore'); //获得store对象
                                                        //在load事件中添加参数
                                                        //mystore.load(
                                                        //{params:{
                                                        //    start:"0",
                                                        //    limit:"25",
                                                        //    searchKeyword:getKeyword,
                                                        //    searchDate:getDate
                                                        //}
                                                        //}
                                                        //);



                                                        mystore.on('beforeload',function(store,options){

                                                            var new_params = {
                                                                searchKeyword:getKeyword,
                                                                searchDate:getDate
                                                            };

                                                            Ext.apply(store.proxy.extraParams,new_params);
                                                        });

                                                        mystore.load(
                                                        {
                                                            params:{
                                                                start:"0",
                                                                limit:"25"
                                                            }
                                                        }
                                                        );
                                                    },
                                                    icon: 'images/file_view0.png',
                                                    text: '搜索'
                                                },
                                                {
                                                    xtype: 'button',
                                                    handler: function(button, event) {

                                                        var channelStore = Ext.StoreMgr.get('InfoChannelStore');
                                                        var win = new Ext.Window({

                                                            title: '信息编辑',
                                                            closable: true,
                                                            layout: 'fit',
                                                            jsonSubmit: true,
                                                            items: [
                                                            {
                                                                xtype: 'form',
                                                                height: 588,
                                                                id: 'articleAddForm',
                                                                layout: {
                                                                    type: 'absolute'
                                                                },
                                                                anchorSize: 100,
                                                                bodyPadding: 10,
                                                                jsonSubmit: true,
                                                                items: [
                                                                {
                                                                    xtype: 'htmleditor',
                                                                    x: 10,
                                                                    y: 130,
                                                                    weight: 1,
                                                                    height: 410,
                                                                    id: 'articleContent',
                                                                    width: 760,
                                                                    fieldLabel: '信息内容',
                                                                    name: 'articleContent'
                                                                },
                                                                {
                                                                    xtype: 'textfield',
                                                                    id: 'articleName',
                                                                    width: 760,
                                                                    fieldLabel: '信息名称',
                                                                    name: 'articleName'
                                                                },
                                                                {
                                                                    xtype: 'textfield',
                                                                    x: 10,
                                                                    y: 50,
                                                                    id: 'articleAuthor',
                                                                    width: 330,
                                                                    fieldLabel: '信息作者',
                                                                    name: 'articleAuthor'
                                                                },

                                                                {
                                                                    xtype: 'combobox',
                                                                    x: 450,
                                                                    y: 50,
                                                                    id: 'channelId',
                                                                    width: 320,
                                                                    fieldLabel: '频道栏目',
                                                                    name: 'channelId',
                                                                    displayField: 'channelName',
                                                                    store: channelStore,
                                                                    valueField: 'channelId',
                                                                    value:13
                                                                },
                                                                {
                                                                    xtype: 'textfield',
                                                                    x: 450,
                                                                    y: 90,
                                                                    id: 'articlePublishtime',
                                                                    width: 320,
                                                                    fieldLabel: '发布时间',
                                                                    hidden:true,
                                                                    name: 'articlePublishtime',
                                                                    inputType: 'date'
                                                                },
                                                                {
                                                                    xtype: 'textfield',
                                                                    x: 10,
                                                                    y: 90,
                                                                    id: 'articleSource',
                                                                    width: 330,
                                                                    fieldLabel: '信息来源',
                                                                    name: 'articleSource'
                                                                },
                                                                {
                                                                    xtype: 'button',
                                                                    handler: function(button, event) {
                                                                        var myform = Ext.getCmp('articleAddForm').getForm();

                                                                        if (myform.isValid()) { // make sure the form contains valid data before submitting
                                                                            myform.submit({
                                                                                url:'add_draftArticle',
                                                                                success: function(form, action) {
                                                                                    Ext.Msg.alert('成功', '修改内容成功');

                                                                                    //var mystore = Ext.StoreMgr.get('ArticlePubJYXCStore'); //获得store对象
                                                                                    //mystore.load();
                                                                                    //{
                                                                                    //params: {
                                                                                    // start: "0",
                                                                                    // limit: "25"
                                                                                    //searchField: Ext.getCmp('searchField_pubNewDynamic').getValue(),
                                                                                    //searchDate: Ext.util.Format.date(Ext.getCmp('searchDate_pubNewDynamic').getValue(), 'Y-m-d');
                                                                                    //}
                                                                                    //}
                                                                                    // );
                                                                                    var mystore = Ext.StoreMgr.get('ArticleDraftBSZNStore'); //获得store对象
                                                                                    mystore.load();
                                                                                    win.close();

                                                                                },
                                                                                failure: function(form, action) {
                                                                                    Ext.Msg.alert('失败', '修改内容失败');
                                                                                    win.close();
                                                                                }
                                                                            });
                                                                        } else {
                                                                            Ext.Msg.alert('注意', '填写信息不能为空，请检查！');
                                                                        }

                                                                        return;
                                                                    },
                                                                    x: 330,
                                                                    y: 560,
                                                                    width: 90,
                                                                    text: '保存为草稿'
                                                                },
                                                                {
                                                                    xtype: 'button',
                                                                    handler: function(button, event) {
                                                                        var myform = Ext.getCmp('articleAddForm').getForm();

                                                                        // Ext.getCmp('').setValues('');
                                                                        if (myform.isValid()) { // make sure the form contains valid data before submitting
                                                                            myform.submit({
                                                                                url:'add_pubArticle',

                                                                                success: function(form, action) {
                                                                                    Ext.Msg.alert('成功', '修改内容成功');

                                                                                    var mystore = Ext.StoreMgr.get('ArticlePubBSZNStore'); //获得store对象
                                                                                    mystore.load();

                                                                                    win.close();

                                                                                },
                                                                                failure: function(form, action) {
                                                                                    Ext.Msg.alert('失败', '修改内容失败');
                                                                                    win.close();
                                                                                }
                                                                            });
                                                                        } else {
                                                                            Ext.Msg.alert('注意', '填写信息不能为空，请检查！');
                                                                        }

                                                                        return;
                                                                    },
                                                                    x: 150,
                                                                    y: 560,
                                                                    width: 90,
                                                                    text: '信息发布'
                                                                },
                                                                {
                                                                    xtype: 'button',
                                                                    handler: function(button, event) {
                                                                        win.close();
                                                                    },
                                                                    x: 510,
                                                                    y: 560,
                                                                    width: 90,
                                                                    text: '取消'
                                                                }
                                                                ]
                                                            }
                                                            ]

                                                        });



                                                        win.show();
                                                    },
                                                    icon: 'images/table_add.png',
                                                    text: '发表新信息'
                                                },
                                                {
                                                    xtype: 'button',
                                                    handler: function(button, event) {
                                                        var grid = Ext.getCmp('articlePubGrid13');
                                                        //var gird = this.down('grid');
                                                        var record = grid.getSelectionModel().getSelection();

                                                        if(record.length === 0){
                                                            Ext.Msg.alert('提示','请先选择您要操作的行！');
                                                            return;

                                                        }else{


                                                            //var articleIds='';
                                                            //for(var i=0;i<record.length;i++)
                                                            //{
                                                            //    articleIds+=record[i].get("articleId");
                                                            //    if(i<record.length-1)articleIds=articleIds+",";
                                                            //}
                                                            //Ext.Msg.alert('提示',articleIds);



                                                            var  articleIds =new Array(record.length);
                                                            for(var i = 0;i<record.length;i++){
                                                                articleIds[i] = record[i].get("articleId");

                                                            }
                                                            //Ext.Msg.alert('提示',articleIds);



                                                            Ext.Ajax.request({
                                                                url:'update_articleToRecycle',
                                                                params:{articleIds:articleIds},

                                                                success:function(response){
                                                                    Ext.Msg.alert('成功','文章放入到回收站');
                                                                    var mystore = Ext.StoreMgr.get('ArticleRecBSZNStore');
                                                                    mystore.load();
                                                                    var mystore2 = Ext.StoreMgr.get('ArticlePubBSZNStore');
                                                                    mystore2.load();

                                                                }

                                                            });

                                                        }
                                                    },
                                                    icon: 'images/table_delete.png',
                                                    text: '移入回收站'
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'pagingtoolbar',
                                            dock: 'bottom',
                                            height: 36,
                                            width: 360,
                                            displayInfo: true,
                                            store: 'ArticlePubBSZNStore'
                                        }
                                    ],
                                    listeners: {
                                        cellclick: {
                                            fn: me.onArticlegridCellClick,
                                            scope: me
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            layout: 'fit',
                            title: '草稿箱',
                            items: [
                                {
                                    xtype: 'gridpanel',
                                    id: 'articleDraftGrid13',
                                    collapsible: false,
                                    title: '',
                                    forceFit: true,
                                    store: 'ArticleDraftBSZNStore',
                                    columns: [
                                        {
                                            xtype: 'rownumberer',
                                            width: 47,
                                            text: '记录号'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'articleName',
                                            text: '标题'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'articleAuthor',
                                            text: '作者'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            width: 420,
                                            dataIndex: 'articleContent',
                                            text: '内容'
                                        }
                                    ],
                                    selModel: Ext.create('Ext.selection.CheckboxModel', {

                                    }),
                                    dockedItems: [
                                        {
                                            xtype: 'toolbar',
                                            dock: 'top',
                                            frame: false,
                                            enableOverflow: true,
                                            items: [
                                                {
                                                    xtype: 'datefield',
                                                    hidden: true,
                                                    id: 'searchDateDraft13',
                                                    width: 204,
                                                    fieldLabel: '起始时间',
                                                    labelWidth: 70,
                                                    format: 'Y-m-d'
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    id: 'searchKeywordDraft13',
                                                    width: 211,
                                                    fieldLabel: '',
                                                    labelWidth: 50,
                                                    emptyText: '请输入搜索关键字'
                                                },
                                                {
                                                    xtype: 'button',
                                                    handler: function(button, event) {
                                                        var getDate = Ext.util.Format.date(Ext.getCmp('searchDateDraft13').getValue(),'Y-m-d');
                                                        var getKeyword = Ext.getCmp('searchKeywordDraft13').getValue();
                                                        var mystore=Ext.StoreMgr.get('ArticleDraftBSZNStore'); //获得store对象
                                                        //在load事件中添加参数
                                                        //mystore.load(
                                                        //{params:{
                                                        //    start:"0",
                                                        //    limit:"25",
                                                        //    searchKeyword:getKeyword,
                                                        //    searchDate:getDate
                                                        //}
                                                        //}
                                                        //);



                                                        mystore.on('beforeload',function(store,options){

                                                            var new_params = {
                                                                searchKeyword:getKeyword,
                                                                searchDate:getDate
                                                            };

                                                            Ext.apply(store.proxy.extraParams,new_params);
                                                        });

                                                        mystore.load(
                                                        {
                                                            params:{
                                                                start:"0",
                                                                limit:"25"
                                                            }
                                                        }
                                                        );
                                                    },
                                                    icon: 'images/file_view0.png',
                                                    text: '搜索'
                                                },
                                                {
                                                    xtype: 'button',
                                                    handler: function(button, event) {
                                                        var grid = Ext.getCmp('articleDraftGrid13');

                                                        var record = grid.getSelectionModel().getSelection();

                                                        if(record.length === 0){
                                                            Ext.Msg.alert('提示','请先选择您要操作的行！');
                                                            return;

                                                        }else{

                                                            var  articleIds =new Array(record.length);
                                                            for(var i = 0;i<record.length;i++){
                                                                articleIds[i] = record[i].get("articleId");

                                                            }
                                                            //Ext.Msg.alert('提示',articleIds);



                                                            Ext.Ajax.request({
                                                                url:'update_articleToPubFromDraft',
                                                                params:{articleIds:articleIds},

                                                                success:function(response){
                                                                    Ext.Msg.alert('成功','文章恢复到已发布');
                                                                    var mystore = Ext.StoreMgr.get('ArticleDraftBSZNStore');
                                                                    mystore.load();
                                                                    var mystore2 = Ext.StoreMgr.get('ArticlePubBSZNStore');
                                                                    mystore2.load();

                                                                }

                                                            });

                                                        }
                                                    },
                                                    icon: 'images/table_add.png',
                                                    text: '信息发布'
                                                },
                                                {
                                                    xtype: 'button',
                                                    handler: function(button, event) {
                                                        var grid = Ext.getCmp('articleDraftGrid13');

                                                        var record = grid.getSelectionModel().getSelection();

                                                        if(record.length === 0){
                                                            Ext.Msg.alert('提示','请先选择您要操作的行！');
                                                            return;

                                                        }else{

                                                            var  articleIds =new Array(record.length);
                                                            for(var i = 0;i<record.length;i++){
                                                                articleIds[i] = record[i].get("articleId");

                                                            }
                                                            //Ext.Msg.alert('提示',articleIds);



                                                            Ext.Ajax.request({
                                                                url:'del_articleByIds',
                                                                params:{articleIds:articleIds},

                                                                success:function(response){
                                                                    Ext.Msg.alert('成功','文章已删除');
                                                                    var mystore = Ext.StoreMgr.get('ArticleDraftBSZNStore');
                                                                    mystore.load();


                                                                }

                                                            });

                                                        }
                                                    },
                                                    icon: 'images/table_delete.png',
                                                    text: '彻底删除'
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'pagingtoolbar',
                                            dock: 'bottom',
                                            height: 36,
                                            width: 360,
                                            displayInfo: true,
                                            store: 'ArticleDraftBSZNStore'
                                        }
                                    ],
                                    listeners: {
                                        cellclick: {
                                            fn: me.onArticlegrid2CellClick,
                                            scope: me
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            layout: 'fit',
                            title: '回收站',
                            items: [
                                {
                                    xtype: 'gridpanel',
                                    id: 'articleRecGrid13',
                                    collapsible: false,
                                    title: '',
                                    forceFit: true,
                                    store: 'ArticleRecBSZNStore',
                                    columns: [
                                        {
                                            xtype: 'rownumberer',
                                            width: 47,
                                            text: '记录号'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'articleName',
                                            text: '标题'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'articleAuthor',
                                            text: '作者'
                                        },
                                        {
                                            xtype: 'datecolumn',
                                            dataIndex: 'articlePublishtime',
                                            text: '发布时间',
                                            format: 'Y-m-d'
                                        }
                                    ],
                                    selModel: Ext.create('Ext.selection.CheckboxModel', {

                                    }),
                                    dockedItems: [
                                        {
                                            xtype: 'toolbar',
                                            dock: 'top',
                                            frame: false,
                                            enableOverflow: true,
                                            items: [
                                                {
                                                    xtype: 'datefield',
                                                    id: 'searchDateRec13',
                                                    width: 204,
                                                    fieldLabel: '起始时间',
                                                    labelWidth: 70,
                                                    format: 'Y-m-d'
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    id: 'searchKeywordRec13',
                                                    width: 211,
                                                    fieldLabel: '',
                                                    labelWidth: 50,
                                                    emptyText: '请输入搜索关键字'
                                                },
                                                {
                                                    xtype: 'button',
                                                    handler: function(button, event) {
                                                        var getDate = Ext.util.Format.date(Ext.getCmp('searchDateRec13').getValue(),'Y-m-d');
                                                        var getKeyword = Ext.getCmp('searchKeywordRec13').getValue();
                                                        var mystore=Ext.StoreMgr.get('ArticleRecBSZNStore'); //获得store对象
                                                        //在load事件中添加参数
                                                        //mystore.load(
                                                        //{params:{
                                                        //    start:"0",
                                                        //    limit:"25",
                                                        //    searchKeyword:getKeyword,
                                                        //    searchDate:getDate
                                                        //}
                                                        //}
                                                        //);



                                                        mystore.on('beforeload',function(store,options){

                                                            var new_params = {
                                                                searchKeyword:getKeyword,
                                                                searchDate:getDate
                                                            };

                                                            Ext.apply(store.proxy.extraParams,new_params);
                                                        });

                                                        mystore.load(
                                                        {
                                                            params:{
                                                                start:"0",
                                                                limit:"25"
                                                            }
                                                        }
                                                        );
                                                    },
                                                    icon: 'images/file_view0.png',
                                                    text: '搜索'
                                                },
                                                {
                                                    xtype: 'button',
                                                    handler: function(button, event) {
                                                        var grid = Ext.getCmp('articleRecGrid13');

                                                        var record = grid.getSelectionModel().getSelection();

                                                        if(record.length === 0){
                                                            Ext.Msg.alert('提示','请先选择您要操作的行！');
                                                            return;

                                                        }else{

                                                            var  articleIds =new Array(record.length);
                                                            for(var i = 0;i<record.length;i++){
                                                                articleIds[i] = record[i].get("articleId");

                                                            }
                                                            //Ext.Msg.alert('提示',articleIds);



                                                            Ext.Ajax.request({
                                                                url:'update_articleToPubFromRec',
                                                                params:{articleIds:articleIds},

                                                                success:function(response){
                                                                    Ext.Msg.alert('成功','文章恢复到已发布');
                                                                    var mystore = Ext.StoreMgr.get('ArticleRecBSZNStore');
                                                                    mystore.load();
                                                                    var mystore2 = Ext.StoreMgr.get('ArticlePubBSZNStore');
                                                                    mystore2.load();

                                                                }

                                                            });

                                                        }
                                                    },
                                                    icon: 'images/table_add.png',
                                                    text: '恢复'
                                                },
                                                {
                                                    xtype: 'button',
                                                    handler: function(button, event) {
                                                        var grid = Ext.getCmp('articleRecGrid13');

                                                        var record = grid.getSelectionModel().getSelection();

                                                        if(record.length === 0){
                                                            Ext.Msg.alert('提示','请先选择您要操作的行！');
                                                            return;

                                                        }else{

                                                            var  articleIds =new Array(record.length);
                                                            for(var i = 0;i<record.length;i++){
                                                                articleIds[i] = record[i].get("articleId");

                                                            }
                                                            //Ext.Msg.alert('提示',articleIds);



                                                            Ext.Ajax.request({
                                                                url:'del_articleByIds',
                                                                params:{articleIds:articleIds},

                                                                success:function(response){
                                                                    Ext.Msg.alert('成功','文章已删除');
                                                                    var mystore = Ext.StoreMgr.get('ArticleRecBSZNStore');
                                                                    mystore.load();


                                                                }

                                                            });

                                                        }
                                                    },
                                                    icon: 'images/table_delete.png',
                                                    text: '彻底删除'
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'pagingtoolbar',
                                            dock: 'bottom',
                                            height: 36,
                                            width: 360,
                                            displayInfo: true,
                                            store: 'ArticleRecBSZNStore'
                                        }
                                    ],
                                    listeners: {
                                        cellclick: {
                                            fn: me.onArticlegrid3CellClick,
                                            scope: me
                                        }
                                    }
                                }
                            ]
                        }
                    ]
                }
            ]
        });

        me.callParent(arguments);
    },

    onArticlegridCellClick: function(tableview, td, cellIndex, record, tr, rowIndex, e, eOpts) {
        if(cellIndex === undefined || cellIndex < 2) return;



        var win = new Ext.Window({

            title:'查看信息详细信息',
            closable:true,
            layout:'fit',
            items:[
            {
                xtype: 'form',
                height: 516,
                id: 'articleScanForm11',
                layout: {
                    type: 'absolute'
                },
                anchorSize: 100,
                bodyPadding: 10,
                jsonSubmit: true,
                items: [
                {
                    xtype: 'displayfield',
                    x: 10,
                    y: 210,
                    weight: 1,
                    height: 360,
                    width: 900,
                    fieldLabel: '信息内容',
                    id: 'articleContent',
                    name: 'articleContent'
                },
                {
                    xtype: 'displayfield',
                    width: 620,
                    fieldLabel: '信息名称',
                    id: 'articleName',
                    name: 'articleName'
                },
                {
                    xtype: 'displayfield',
                    x: 10,
                    y: 90,
                    width: 290,
                    fieldLabel: '信息作者',
                    id: 'articleAuthor',
                    name: 'articleAuthor'
                },
                {
                    xtype: 'displayfield',
                    x: 10,
                    y: 170,
                    width: 280,
                    fieldLabel: '发布时间',
                    id: 'articlePublishtime',
                    name: 'articlePublishtime'
                },
                {
                    xtype: 'displayfield',
                    x: 10,
                    y: 130,
                    width: 290,
                    fieldLabel: '信息来源',
                    id: 'articleSource',
                    name: 'articleSource'
                },{
                    xtype: 'displayfield',
                    x: 10,
                    y: 50,
                    id: 'channelId',
                    width: 320,
                    fieldLabel: '频道栏目',
                    name: 'channelId'


                }

                ]
            }
            ]


        });
        Ext.getCmp('articleContent').setValue(record.data.articleContent);
        Ext.getCmp('channelId').setValue('办事指南');
        Ext.getCmp('articleName').setValue(record.data.articleName);
        Ext.getCmp('articleAuthor').setValue(record.data.articleAuthor);
        Ext.getCmp('articlePublishtime').setValue(record.data.articlePublishtime);
        Ext.getCmp('articleSource').setValue(record.data.articleSource);

        win.show();
    },

    onArticlegrid2CellClick: function(tableview, td, cellIndex, record, tr, rowIndex, e, eOpts) {
        if (cellIndex === undefined || cellIndex < 2) return;

        //var newArticleTab = Ext.widget('infoArtilceScanTab');
        var channelStore = Ext.StoreMgr.get('InfoChannelStore');
        var win = new Ext.Window({

            title: '信息编辑',
            closable: true,
            layout: 'fit',
            jsonSubmit: true,
            items: [{
                xtype: 'form',
                height: 588,
                id: 'articleDraftUpdateForm11',

                jsonSubmit: true,
                layout: {
                    type: 'absolute'
                },
                anchorSize: 100,
                bodyPadding: 10,

                items: [{
                    xtype: 'textfield',
                    id: 'articleId',
                    fieldLabel: '信息ID',
                    hidden: true,
                    name: 'articleId'
                },
                {
                    xtype: 'textfield',
                    id:'articleIsrecycle',
                    fieldLabel: '是否在回收站',
                    hidden: true,
                    name: 'articleIsrecycle'
                },
                {
                    xtype: 'textfield',
                    id: 'articleIsdraft',
                    fieldLabel: '是否在草稿箱',
                    hidden: true,
                    name: 'articleIsdraft'
                },
                {
                    xtype: 'htmleditor',
                    x: 10,
                    y: 130,
                    weight: 1,
                    height: 410,
                    id: 'articleContent',
                    width: 760,
                    fieldLabel: '信息内容',
                    name: 'articleContent'
                },
                {
                    xtype: 'textfield',
                    id: 'articleName',
                    width: 760,
                    fieldLabel: '信息名称',
                    name: 'articleName'
                },
                {
                    xtype: 'textfield',
                    x: 10,
                    y: 50,
                    id: 'articleAuthor',
                    width: 330,
                    fieldLabel: '信息作者',
                    name: 'articleAuthor'

                },
                {
                    xtype: 'combobox',
                    x: 450,
                    y: 50,
                    id: 'channelId',
                    width: 320,
                    fieldLabel: '频道栏目',
                    name: 'channelId',
                    displayField: 'channelName',
                    store: channelStore,
                    valueField: 'channelId',
                    value:13
                },
                {
                    xtype: 'textfield',
                    x: 450,
                    y: 90,
                    hidden: true,
                    id: 'articlePublishtime',
                    width: 320,
                    fieldLabel: '发布时间',
                    name: 'articlePublishtime',
                    inputType: 'date'
                },
                {
                    xtype: 'textfield',
                    x: 10,
                    y: 90,
                    id: 'articleSource',
                    width: 330,
                    fieldLabel: '信息来源',
                    name: 'articleSource'
                },{
                    xtype: 'button',
                    x: 118,
                    y: 561,
                    width: 90,
                    text: '保存',
                    handler: function() {
                        var myform = Ext.getCmp('articleDraftUpdateForm11').getForm();
                        if (myform.isValid()) { // make sure the form contains valid data before submitting
                            myform.submit({
                                url:'update_draftArticle',
                                success: function(form, action) {
                                    Ext.Msg.alert('成功', '修改内容成功');

                                    var mystore = Ext.StoreMgr.get('ArticleDraftBSZNStore'); //获得store对象
                                    mystore.load();
                                    //{
                                    //params: {
                                    // start: "0",
                                    // limit: "25"
                                    //searchField: Ext.getCmp('searchField_pubNewDynamic').getValue(),
                                    //searchDate: Ext.util.Format.date(Ext.getCmp('searchDate_pubNewDynamic').getValue(), 'Y-m-d');
                                    //}
                                    //}
                                    // );

                                    win.close();

                                },
                                failure: function(form, action) {
                                    Ext.Msg.alert('失败', '修改内容失败');
                                    win.close();
                                }
                            });
                        } else {
                            Ext.Msg.alert('注意', '填写信息不能为空，请检查！');
                        }

                        return;

                    }
                },
                {
                    xtype: 'button',
                    x: 250,
                    y: 560,
                    width: 90,
                    text: '取消',
                    handler:function(){
                        win.close();
                    }
                }


                ]

            }]

        });
        Ext.getCmp('articleId').setValue(record.data.articleId);
        //Ext.getCmp('channelId').setValue('办事指南');
        Ext.getCmp('articleIsrecycle').setValue(record.data.articleIsrecycle);
        Ext.getCmp('articleIsdraft').setValue(record.data.articleIsdraft);
        Ext.getCmp('articleContent').setValue(record.data.articleContent);
        Ext.getCmp('articleName').setValue(record.data.articleName);
        Ext.getCmp('articleAuthor').setValue(record.data.articleAuthor);
        Ext.getCmp('articleSource').setValue(record.data.articleSource);
        Ext.getCmp('articlePublishtime').setValue(record.data.articlePublishtime);


        win.show();
    },

    onArticlegrid3CellClick: function(tableview, td, cellIndex, record, tr, rowIndex, e, eOpts) {
        if (cellIndex === undefined || cellIndex < 2) return;

        var channelStore = Ext.StoreMgr.get('InfoChannelStore');
        var win = new Ext.Window({

            title: '信息编辑',
            closable: true,
            layout: 'fit',
            jsonSubmit: true,
            items: [{
                xtype: 'form',
                height: 588,
                id: 'articleRecUpdateForm11',

                jsonSubmit: true,
                layout: {
                    type: 'absolute'
                },
                anchorSize: 100,
                bodyPadding: 10,

                items: [{
                    xtype: 'textfield',
                    id: 'articleId',
                    width: 760,
                    fieldLabel: '信息ID',
                    hidden: true,
                    name: 'articleId'
                },
                {
                    xtype: 'combobox',
                    x: 350,
                    y: 50,
                    id: 'channelId',
                    width: 290,
                    fieldLabel: '频道栏目',
                    name: 'channelId',
                    displayField: 'channelName',
                    store: channelStore,
                    valueField: 'channelId',
                    value:13
                },
                {
                    xtype: 'textfield',
                    id: 'articleIsrecycle',
                    width: 760,
                    fieldLabel: '是否在回收站',
                    hidden: true,
                    name: 'articleIsrecycle'
                },
                {
                    xtype: 'textfield',
                    id: 'articleIsdraft',
                    width: 760,
                    fieldLabel: '是否在草稿箱',
                    hidden: true,
                    name: 'articleIsdraft'
                },
                {
                    xtype: 'htmleditor',
                    x: 10,
                    y: 150,
                    weight: 1,
                    height: 360,
                    id: 'articleContent',
                    width: 760,
                    fieldLabel: '信息内容',
                    name: 'articleContent'
                },
                {
                    xtype: 'textfield',
                    id: 'articleName',
                    width: 620,
                    fieldLabel: '信息名称',
                    name: 'articleName'
                },
                {
                    xtype: 'textfield',
                    x: 10,
                    y: 50,
                    id: 'articleAuthor',
                    width: 290,
                    fieldLabel: '信息作者',
                    name: 'articleAuthor'
                },
                {
                    xtype: 'textfield',
                    x: 350,
                    y: 100,
                    id: 'articlePublishtime',
                    width: 290,
                    fieldLabel: '发布时间',
                    name: 'articlePublishtime',
                    inputType: 'date'
                },
                {
                    xtype: 'textfield',
                    x: 10,
                    y: 100,
                    id: 'articleSource',
                    width: 290,
                    fieldLabel: '信息来源',
                    name: 'articleSource'
                },
                {
                    xtype: 'button',
                    x: 118,
                    y: 561,
                    width: 90,
                    text: '保存',
                    handler: function() {
                        var myform = Ext.getCmp('articleRecUpdateForm11').getForm();
                        if (myform.isValid()) { // make sure the form contains valid data before submitting
                            myform.submit({
                                url:'update_recArticle',
                                success: function(form, action) {
                                    Ext.Msg.alert('成功', '修改内容成功');

                                    var mystore = Ext.StoreMgr.get('ArticleRecBSZNStore'); //获得store对象
                                    mystore.load();
                                    //{
                                    //params: {
                                    // start: "0",
                                    // limit: "25"
                                    //searchField: Ext.getCmp('searchField_pubNewDynamic').getValue(),
                                    //searchDate: Ext.util.Format.date(Ext.getCmp('searchDate_pubNewDynamic').getValue(), 'Y-m-d');
                                    //}
                                    //}
                                    // );

                                    win.close();

                                },
                                failure: function(form, action) {
                                    Ext.Msg.alert('失败', '修改内容失败');
                                    win.close();
                                }
                            });
                        } else {
                            Ext.Msg.alert('注意', '填写信息不能为空，请检查！');
                        }

                        return;

                    }
                },
                {
                    xtype: 'button',
                    x: 250,
                    y: 560,
                    width: 90,
                    text: '取消',
                    handler:function(){
                        win.close();
                    }
                }]
            }]

        });
        Ext.getCmp('articleId').setValue(record.data.articleId);
        //Ext.getCmp('channelId').setValue(record.data.channelId);
        Ext.getCmp('articleIsrecycle').setValue(record.data.articleIsrecycle);
        Ext.getCmp('articleIsdraft').setValue(record.data.articleIsdraft);
        Ext.getCmp('articleContent').setValue(record.data.articleContent);
        Ext.getCmp('articleName').setValue(record.data.articleName);
        Ext.getCmp('articleAuthor').setValue(record.data.articleAuthor);
        Ext.getCmp('articleSource').setValue(record.data.articleSource);
        Ext.getCmp('articlePublishtime').setValue(record.data.articlePublishtime);


        win.show();
    }

});