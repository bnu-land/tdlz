/*
 * File: app/view/use_MonitoringSampling.js
 *
 * This file was generated by Sencha Architect version 3.1.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.view.use_MonitoringSampling', {
    extend: 'Ext.panel.Panel',
    alias: 'widget.use_MonitoringSampling',

    requires: [
        'Ext.form.field.Checkbox',
        'Ext.button.Button',
        'Ext.form.field.ComboBox',
        'Ext.grid.Panel',
        'Ext.grid.column.Column',
        'Ext.form.field.Number',
        'Ext.grid.View',
        'Ext.grid.plugin.CellEditing'
    ],

    height: 647,
    id: 'use_MonitoringSampling',
    width: 900,
    layout: 'fit',
    title: '监测抽样',

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'panel',
                    layout: 'border',
                    items: [
                        {
                            xtype: 'panel',
                            region: 'east',
                            split: true,
                            width: 300,
                            layout: 'border',
                            items: [
                                {
                                    xtype: 'panel',
                                    region: 'north',
                                    split: true,
                                    height: 174,
                                    layout: 'border',
                                    title: '抽样地图数据输入',
                                    items: [
                                        {
                                            xtype: 'panel',
                                            region: 'west',
                                            border: false,
                                            width: 25,
                                            layout: {
                                                type: 'vbox',
                                                align: 'stretch'
                                            },
                                            items: [
                                                {
                                                    xtype: 'checkboxfield',
                                                    margins: '',
                                                    id: 'check_useSampling_ditu',
                                                    margin: '2,2,2,2',
                                                    labelWidth: 30,
                                                    inputValue: 'true'
                                                },
                                                {
                                                    xtype: 'checkboxfield',
                                                    flex: 1,
                                                    id: 'check_useSampling_baogao',
                                                    margin: '3,2,2,2',
                                                    labelWidth: 30,
                                                    inputValue: 'true'
                                                },
                                                {
                                                    xtype: 'checkboxfield',
                                                    flex: 1,
                                                    id: 'check_useSampling_yangben',
                                                    margin: '3,2,2,2',
                                                    labelWidth: 30,
                                                    inputValue: 'true'
                                                },
                                                {
                                                    xtype: 'checkboxfield',
                                                    id: 'check_useSampling_fanwei',
                                                    margin: '3,2,2,2',
                                                    labelWidth: 30,
                                                    inputValue: 'true'
                                                },
                                                {
                                                    xtype: 'checkboxfield',
                                                    id: 'check_useSampling_zhishi',
                                                    margin: '3,2,2,2',
                                                    labelWidth: 30,
                                                    inputValue: 'true'
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'panel',
                                            region: 'center',
                                            border: false,
                                            layout: {
                                                type: 'vbox',
                                                align: 'stretch'
                                            },
                                            items: [
                                                {
                                                    xtype: 'textfield',
                                                    margins: '2,0,0,0',
                                                    id: 'text_useSampling_ditu',
                                                    fieldLabel: '抽样底图',
                                                    labelWidth: 60,
                                                    readOnly: true
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    flex: 1,
                                                    id: 'text_useSampling_baogao',
                                                    fieldLabel: '报告层',
                                                    labelWidth: 60,
                                                    readOnly: true
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    flex: 1,
                                                    id: 'text_useSampling_yangben',
                                                    fieldLabel: '样本层',
                                                    labelWidth: 60,
                                                    readOnly: true
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    id: 'text_useSampling_fanwei',
                                                    fieldLabel: '抽样范围',
                                                    labelWidth: 60,
                                                    readOnly: true
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    id: 'text_useSampling_zhishi',
                                                    fieldLabel: '知识层',
                                                    labelWidth: 60,
                                                    readOnly: true
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'panel',
                                            region: 'east',
                                            border: false,
                                            width: 45,
                                            items: [
                                                {
                                                    xtype: 'button',
                                                    id: 'btn_useSampling_ditu',
                                                    margin: '2,2,2,2',
                                                    text: '浏览',
                                                    listeners: {
                                                        click: {
                                                            fn: me.onBtn_useSampling_dituClick,
                                                            scope: me
                                                        }
                                                    }
                                                },
                                                {
                                                    xtype: 'button',
                                                    id: 'btn_useSampling_baogao',
                                                    margin: '3,2,2,2',
                                                    text: '浏览',
                                                    listeners: {
                                                        click: {
                                                            fn: me.onBtn_useSampling_baogaoClick,
                                                            scope: me
                                                        }
                                                    }
                                                },
                                                {
                                                    xtype: 'button',
                                                    id: 'btn_useSampling_yangben',
                                                    margin: '3,2,2,2',
                                                    text: '浏览',
                                                    listeners: {
                                                        click: {
                                                            fn: me.onBtn_useSampling_yangbenClick,
                                                            scope: me
                                                        }
                                                    }
                                                },
                                                {
                                                    xtype: 'button',
                                                    id: 'btn_useSampling_fanwei',
                                                    margin: '3,2,2,2',
                                                    text: '浏览',
                                                    listeners: {
                                                        click: {
                                                            fn: me.onBtn_useSampling_fanweiClick,
                                                            scope: me
                                                        }
                                                    }
                                                },
                                                {
                                                    xtype: 'button',
                                                    id: 'btn_useSampling_zhishi',
                                                    margin: '3,2,2,2',
                                                    text: '浏览',
                                                    listeners: {
                                                        click: {
                                                            fn: me.onBtn_useSampling_zhishiClick,
                                                            scope: me
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    xtype: 'panel',
                                    region: 'center',
                                    title: '抽样参数设置',
                                    layout: {
                                        type: 'vbox',
                                        align: 'stretch'
                                    },
                                    items: [
                                        {
                                            xtype: 'panel',
                                            height: 123,
                                            layout: 'column',
                                            items: [
                                                {
                                                    xtype: 'textfield',
                                                    id: 'text_useSampling_zhishiCount',
                                                    margin: '3,5,3,5',
                                                    width: 130,
                                                    fieldLabel: '知识层数',
                                                    labelWidth: 75
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    id: 'text_useSampling_zhishiTotal',
                                                    margin: '3,5,3,5',
                                                    width: 130,
                                                    fieldLabel: '总体个数',
                                                    labelWidth: 75
                                                },
                                                {
                                                    xtype: 'combobox',
                                                    id: 'combo_useSampling_chouyangRate',
                                                    margin: '3,5,3,5',
                                                    width: 130,
                                                    fieldLabel: '抽样比',
                                                    labelWidth: 75,
                                                    store: [
                                                        [
                                                            '1',
                                                            '90%'
                                                        ],
                                                        [
                                                            '2',
                                                            '80%'
                                                        ],
                                                        [
                                                            '3',
                                                            '70%'
                                                        ],
                                                        [
                                                            '4',
                                                            '60%'
                                                        ],
                                                        [
                                                            '5',
                                                            '50%'
                                                        ],
                                                        [
                                                            '6',
                                                            '40%'
                                                        ],
                                                        [
                                                            '7',
                                                            '30%'
                                                        ],
                                                        [
                                                            '8',
                                                            '20%'
                                                        ],
                                                        [
                                                            '9',
                                                            '10%'
                                                        ]
                                                    ]
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    margin: '3,5,3,5',
                                                    width: 130,
                                                    fieldLabel: '抽样期望精度',
                                                    labelWidth: 80,
                                                    emptyText: '0.05'
                                                },
                                                {
                                                    xtype: 'checkboxfield',
                                                    margin: '3,5,3,5',
                                                    width: 130,
                                                    fieldLabel: '费用未知',
                                                    labelWidth: 75,
                                                    boxLabel: '',
                                                    inputValue: 'true',
                                                    uncheckedValue: 'false',
                                                    listeners: {
                                                        change: {
                                                            fn: me.onCheckboxfieldChange,
                                                            scope: me
                                                        }
                                                    }
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    id: 'text_use_basicFee',
                                                    margin: '3,5,3,5',
                                                    width: 130,
                                                    fieldLabel: '基本费用',
                                                    labelWidth: 75,
                                                    emptyText: '2000'
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    id: 'text_use_PerFee',
                                                    margin: '3,5,3,5',
                                                    width: 130,
                                                    fieldLabel: '单样本费用',
                                                    labelWidth: 75,
                                                    emptyText: '40'
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    id: 'text_use_totalFee',
                                                    margin: '3,5,3,5',
                                                    width: 130,
                                                    fieldLabel: '总费用',
                                                    labelWidth: 75,
                                                    emptyText: '15000'
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'gridpanel',
                                            height: 149,
                                            id: 'grid_useSampling_feeSet',
                                            columns: [
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'layername',
                                                    text: '层名'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    width: 60,
                                                    dataIndex: 'sqrt',
                                                    text: '平方根',
                                                    editor: {
                                                        xtype: 'numberfield'
                                                    }
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    width: 60,
                                                    dataIndex: 'fee',
                                                    text: '费用',
                                                    editor: {
                                                        xtype: 'textfield'
                                                    }
                                                }
                                            ],
                                            listeners: {
                                                afterrender: {
                                                    fn: me.onGridpanelAfterRender,
                                                    scope: me
                                                }
                                            },
                                            plugins: [
                                                Ext.create('Ext.grid.plugin.CellEditing', {

                                                })
                                            ]
                                        },
                                        {
                                            xtype: 'button',
                                            height: 51,
                                            margin: 5,
                                            minWidth: 240,
                                            text: '生成抽样点并计算样本量',
                                            listeners: {
                                                click: {
                                                    fn: me.onButtonClick,
                                                    scope: me
                                                }
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            region: 'center',
                            split: true,
                            html: '<div id = "mapdiv_MonitoringSampling" style = "width=100%;height:100%;">\r\n</div>',
                            title: '地图预览',
                            listeners: {
                                afterrender: {
                                    fn: me.onPanelAfterRender,
                                    scope: me
                                }
                            }
                        }
                    ]
                }
            ]
        });

        me.callParent(arguments);
    },

    onBtn_useSampling_dituClick: function(button, e, eOpts) {
        var win = Ext.widget('use_SelectLayerWindow');
        win.show();
        Ext.getCmp('hide_useSampling_whichLayer').setValue('ditu');
    },

    onBtn_useSampling_baogaoClick: function(button, e, eOpts) {
        var win = Ext.widget('use_SelectLayerWindow');
        win.show();
        Ext.getCmp('hide_useSampling_whichLayer').setValue('baogao');
    },

    onBtn_useSampling_yangbenClick: function(button, e, eOpts) {
        var win = Ext.widget('use_SelectLayerWindow');
        win.show();
        Ext.getCmp('hide_useSampling_whichLayer').setValue('yangben');
    },

    onBtn_useSampling_fanweiClick: function(button, e, eOpts) {
        var win = Ext.widget('use_SelectLayerWindow');
        win.show();
        Ext.getCmp('hide_useSampling_whichLayer').setValue('fanwei');
    },

    onBtn_useSampling_zhishiClick: function(button, e, eOpts) {
        var win = Ext.widget('use_SelectLayerWindow');
        win.show();
        Ext.getCmp('hide_useSampling_whichLayer').setValue('zhishi');
    },

    onCheckboxfieldChange: function(field, newValue, oldValue, eOpts) {
        if(newValue){
            Ext.getCmp('text_use_basicFee').disable();
            Ext.getCmp('text_use_PerFee').disable();
            Ext.getCmp('text_use_totalFee').disable();
        }else{
            Ext.getCmp('text_use_basicFee').enable();
            Ext.getCmp('text_use_PerFee').enable();
            Ext.getCmp('text_use_totalFee').enable();
        }
    },

    onGridpanelAfterRender: function(component, eOpts) {
        var data = [
            { 'layername': '极度敏感区', 'sqrt': '32', 'fee': '800' },
            { 'layername': '高度敏感区', 'sqrt': '97', 'fee': '6400' },
            { 'layername': '中度敏感区', 'sqrt': '64', 'fee': '3000' },
            { 'layername': '低度敏感区', 'sqrt': '54', 'fee': '1800' },
            { 'layername': '不敏感区', 'sqrt': '42', 'fee': '1000' }
        ];
        var store = new Ext.data.JsonStore({
            data: data,
            fields: ['layername', 'sqrt','fee']
        });
        Ext.getCmp('grid_useSampling_feeSet').reconfigure(store);
    },

    onButtonClick: function(button, e, eOpts) {
        var tabs = Ext.getCmp('myTabPanel');
        tabs.removeAll(true);
        var newtab = tabs.add(Ext.widget('use_MonitorResult'));
    },

    onPanelAfterRender: function(component, eOpts) {
        //加入地图的js文件
        var head = document.getElementsByTagName('head')[0];
        var script= document.createElement("script");
        script.type = "text/javascript";
        script.src="map/UseMonitoringSampling_map.js";
        head.appendChild(script);
    }

});